#!/usr/bin/env cbqn
âŸ¨IntsâŸ© â† â€¢Import "utils.bqn"
i â† âˆ¾{2â†•âˆ˜â€¿2â¥Šğ•©}âˆ˜IntsÂ¨â€¢FLines â‰ â—¶"14.in"â€¿âŠ‘ â€¢args

Set1 â† {ğ•¨ 1âŒ¾((+Â´ğ•©Ã—1Â«â‰¢ğ•¨)âŠ‘â¥Š)â†©}

Run â† {
  min â† Â¯1+0âŠ¸âŒŠâŒ¾(1âŠ¸âŠ‘) âŒŠËâˆ¾Ëğ•©
  l â† -â‰1âŸœmin ğ•©
  max â† âŒˆËâˆ¾Ël
  b â† â‰ âˆŠâŸœ(âˆ¾{(<âŠğ•©)+â¥Š(<âˆ˜Ã—Ã—Â·â†•1+|)-ËâŒ½ğ•©}Â¨ <Ë˜l)âŒ¾â¥Š â†•2+max
  lx â† Â¯1+â‰ âŠb
  ly â† Â¯1+â‰ b
  
  res â† 0
  Fill â† {
    ğ•©âŠ‘b? 1;
    ğ•Š yâ€¿x: {
      (ly=y+1)âˆ¨(x=0)âˆ¨x=lx? 0;
      Fill âŸ¨y+1, xâŸ©?
      Fill âŸ¨y+1, x-1âŸ©?
      Fill âŸ¨y+1, x+1âŸ©?
        res+â†© 1
        b Set1â†© ğ•©
        1;
      0
    }ğ•©
  }
  Fill âŒ½500â€¿0-min
  â€¢Show res
}

Run i
ji â† 500â€¿0âˆ¾âˆ¾Ëi
max â† âŒˆËji
min â† âŒŠËji
by â† 2+1âŠ‘max
i2 â† iâˆ¾ [âŸ¨by-ËœâŠ‘min, byâŸ©, âŸ¨by+âŠ‘max, byâŸ©]
Run i2