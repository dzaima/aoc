#!/usr/bin/env cbqn
âŸ¨IntsâŸ© â† â€¢Import "../../utils/utils.bqn"
i â† âˆ¾{2â†•âˆ˜â€¿2â¥Šğ•©}âˆ˜IntsÂ¨â€¢FLines â‰ â—¶"14.in"â€¿âŠ‘ â€¢args

Set1 â† {ğ•¨ 1âŒ¾((+Â´ğ•©Ã—1Â«â‰¢ğ•¨)âŠ‘â¥Š)â†©}

Run â† {
  min â† Â¯1+0âŠ¸âŒŠâŒ¾(1âŠ¸âŠ‘) âŒŠËâˆ¾Ëğ•©
  ğ•© -â‰1âŸœminâ†©
  b â† â‰ âˆŠâŸœ(âˆ¾{(<âŠğ•©)+â¥Š(<âˆ˜Ã—Ã—Â·â†•1+|)-ËâŒ½ğ•©}Â¨ <Ë˜ğ•©)âŒ¾â¥Š â†•2+âŒˆËâˆ¾Ëğ•©
  oobx â† Â¯1+â‰ âŠb
  ooby â† Â¯1+â‰ b
  
  res â† 0
  Fill â† {
    ğ•¨â€¿ğ•©âŠ‘b? 1;
    (ooby=ğ•¨+1)âˆ¨(ğ•©=0)âˆ¨ğ•©=oobx? 0;
    (ğ•¨+1) Fill ğ•©?
    (ğ•¨+1) Fill ğ•©-1?
    (ğ•¨+1) Fill ğ•©+1?
      res+â†© 1
      b Set1â†© ğ•¨â€¿ğ•©
      1;
    0
  }
  FillÂ´ âŒ½500â€¿0-min
  â€¢Show res
}

Run i
ji â† 500â€¿0âˆ¾âˆ¾Ëi
max â† âŒˆËji
min â† âŒŠËji
by â† 2+1âŠ‘max
i2 â† iâˆ¾ [âŸ¨by-ËœâŠ‘min, byâŸ©, âŸ¨by+âŠ‘max, byâŸ©]
Run i2