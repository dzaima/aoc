#!/usr/bin/env cbqn
âŸ¨IntsâŸ© â† â€¢Import "utils.bqn"
i â† âˆ¾{2â†•âˆ˜â€¿2â¥Šğ•©}âˆ˜IntsÂ¨â€¢FLines â‰ â—¶"14.in"â€¿âŠ‘ â€¢args

Set1 â† {ğ•¨ 1âŒ¾((+Â´ğ•©Ã—1Â«â‰¢ğ•¨)âŠ‘â¥Š)â†©}

Run â† {
  min â† Â¯1+0âŠ¸âŒŠâŒ¾(1âŠ¸âŠ‘) âŒŠËâˆ¾Ëğ•©
  l â† -â‰1âŸœmin ğ•©
  max â† âŒˆËâˆ¾Ël
  b â† â‰(â†•2+max) âˆŠ âˆ¾{(<âŠğ•©)+â¥Š(<âˆ˜Ã—Ã—Â·â†•1+|)-ËâŒ½ğ•©}Â¨ <Ë˜l
  s â† 0âŒˆâŒ½500â€¿0-min

  lx â† Â¯1+â‰ âŠb
  ly â† Â¯1+â‰ b

  Step â† {
    ğ•©âŠ‘b? @;
    yâ€¿x:
    {
      y+â†©1
      (y=ly)âˆ¨(x=0)âˆ¨x=lx? @;
      Â¬(pâ†âŸ¨y, xâŸ©)âŠ‘b? p;
      Â¬(pâ†âŸ¨y, x-1âŸ©)âŠ‘b? p;
      Â¬(pâ†âŸ¨y, x+1âŸ©)âŠ‘b? p;
      â‹ˆğ•©
    }ğ•©
  }
  n â† 0
  Drop â† { ğ•Š:
    e â† âŠ‘Step â€¢_while_ (1<â‰ ) s
    eâ‰¢@?
      b Set1â†© e
      n+â†©1
      1
    ;
      0
  }
  Dropâ€¢_while_âŠ¢â€¢_timed 1
  â€¢Show n
}

Run i
ji â† 500â€¿0âˆ¾âˆ¾Ëi
max â† âŒˆËji
min â† âŒŠËji
by â† 2+1âŠ‘max
i2 â† iâˆ¾ [âŸ¨by-ËœâŠ‘min, byâŸ©, âŸ¨by+âŠ‘max, byâŸ©]
Run i2