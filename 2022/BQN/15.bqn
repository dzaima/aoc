#!/usr/bin/env cbqn
âŸ¨SIntsâŸ© â† â€¢Import "utils.bqn"
l â† SIntsÂ¨ â€¢FLines â‰ â—¶"15.in"â€¿âŠ‘ â€¢args
sp â† <Ë˜â‰>2â†‘Â¨l
bp â† <Ë˜â‰>2â†“Â¨l
d â† +Â´|sp-bp

testInput â† 0 # âˆ§Â´(âŒˆËâˆ¾2â€¿2âŠ¸â¥ŠÂ¨ l)â‰¤1000
y â† {testInput? 10; 2000000}
m â† {testInput? 20; 4000000}

spxâ€¿spy â† sp
_ranges â† { ğ”½_ğ•£ y:
  range â† d-|spy-ğ•©
  xsâ€¿ws â† (<rangeâ‰¥0)/Â¨ spxâ€¿range
  x0â€¿x1 â† ğ”½ âŸ¨xs-ws, xs+wsâŸ©
  x0â€¿x1 (â‹x0)âŠ¸âŠÂ¨â†©
  x1 âŒˆ`â†©
  yâ€¿x0â€¿x1
}

{
  Â·â€¿x0â€¿x1 â† âŠ¢_ranges y
  x1âŒŠâ†© âˆÂ«x0
  â€¢Show +Â´x1-x0
}

{ yâ€¿x0â€¿x1:
  0â‰ â‰ râ†((2+Â»x1)=x0)/x0?
  â€¢Show y+4000000Ã—â‹ˆâ¼r-1;
  1
}âˆ˜({mâŒŠ0âŒˆğ•©}_ranges)Â¨ â†•m