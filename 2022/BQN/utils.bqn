# âŸ¨RB, B10, Num, SInt, Ints, SInts, Split, SplitF, ReIndex, MDSlash, Unjoin, Count, GCD, LCM, _fx_, _fi_, TâŸ© â† â€¢Import "utils.bqn"
RB â‡ 2âŠ¸Ã—âŠ¸+ËœÂ´âŒ½
B10 â‡ 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½
Num â‡ B10 -âŸœ'0'
SInt â‡ {'-'=âŠ‘ğ•©?-Num 1â†“ğ•©;Numğ•©}
Ints â‡ {NumÂ¨((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)ğ•©âˆŠ'0'+â†•10)âŠ”ğ•©}
SInts â‡ {SIntÂ¨((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)ğ•©âˆŠ'-'âˆ¾'0'+â†•10)âŠ”ğ•©}
Split â‡ {((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)Â¬ğ•©=ğ•¨)âŠ”ğ•©}
SplitF â‡ {((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)Â¬ğ•¨âŠ¸â‰¡Â¨ğ•©)âŠ”ğ•©}
ReIndex â‡ {<Ë˜ğ•¨|â‰1âŒŠğ•©Ã·âŒœ1Â«Ã—`âŒ¾âŒ½ğ•¨} # convert indices into a shape-âŸ¨Ã—Â´ğ•¨âŸ© array into corresponding indices into a shape-ğ•¨ one
MDSlash â‡ {(0.13Ã—â‰ â¥Šğ•©)>+Â´â¥Šğ•©? (â‰¢ğ•©) ReIndex /â¥Šğ•©; /â—‹â¥ŠâŸœâ†•âŸœâ‰¢ ğ•©}
Unjoin â‡ {((â‰ Â¨ğ•¨)/â†•â‰ ğ•¨) âŠ” ğ•©}
Count â‡ âŠËœâˆ˜âŠ£âŠ â‰ âˆ˜âŠ£â†‘ /â¼âˆ˜âŠ
GCD â‡ {ğ•¨(|ğ•ŠâŸ(>âŸœ0)âŠ£)ğ•©}
LCM â‡ Ã—Ã·GCD
_fx_ â‡ {F _ğ•£_ ğ”¾ ğ•©: âŠ‘{pâ€¿n:nâ‹ˆF n}â€¢_while_(ğ”¾Â´) ğ•©â‹ˆğ”½ğ•©} # fixed-point
_fi_ â‡ {F _ğ•£_ ğ”¾ ğ•©: Â¯1â†“{ğ•©âˆ¾<F Â¯1âŠ‘ğ•©}â€¢_while_(ğ”¾Â´Â¯2â†‘âŠ¢) ğ•©â‹ˆğ”½ğ•©} # fixed-point with immediates
T â‡ {
  1â‰¡=ğ•©? <â‰1â‰>ğ•©;
  1â‰¡=âŠ‘ğ•©? <Ë˜â‰â¼>ğ•©;
  =âŠ¸{<â‰ğ•¨â‰âŸğ•¨>ğ•©} ğ•©
} # depth-transpose
