#!/usr/bin/env bqn
âŸ¨Split, LCM, SplitF, Num, IntsâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† âŸ¨âŸ©SplitF â€¢FLines â‰ â—¶"11.in"â€¿âŠ‘ â€¢args

m â† { aâ€¿bâ€¿câ€¿dâ€¿eâ€¿f:
  id â‡ âŠ‘Ints a
  start â‡ Ints b
  op â† 19â†“c
  fn â‡ {fâ€¿gâ€¿h: F G H} {(âŠ‘"+*"âŠğ•©)âŠ‘+â€¿Ã—}âŒ¾(1âŠ¸âŠ‘) {"old": âŠ¢; Num ğ•©}Â¨âŒ¾(0â€¿2âŠ¸âŠ) ' 'Split op
  test â‡ Num 21â†“d
  throw â‡ âŸ¨Num 29â†“e, Num 30â†“fâŸ©
  curr â‡ @ â‹„ _modCurr â‡ {curr ğ”½â†© ğ•©}
  insp â‡ @ â‹„ _modInsp â‡ {insp ğ”½â†© ğ•©}
}Â¨ l

mod â† LCMÂ´ {ğ•©.test}Â¨ m

_step â† { Calm _ğ•£ c:
  +c._modInsp â‰ c.curr
  {
    w â† Calm c.Fn ğ•©
    to â† (0â‰ c.test|w)âŠ‘c.throw
    âˆ¾(toâŠ‘m)._modCurr w
  }Â¨ (âŠ¢ ğ•©._modCurr âŸ¨âŸ©) âŠ¢ ğ•©.curr
}

_rounds â† {
  {âŠ¢ ğ•©._modInsp 0 â‹„ âŠ¢ ğ•©._modCurr ğ•©.start}Â¨ m
  ğ”½ _stepÂ¨âˆ˜mâŸğ•© @
  Ã—Â´2â†‘âˆ¨{ğ•©.insp}Â¨ m
}

â€¢Show {âŒŠğ•©Ã·3} _rounds 20
â€¢Show modâŠ¸| _rounds 10000