#!/usr/bin/env cbqn
âŸ¨RB, B10, Num, Ints, SInts, SplitâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† 1âŠ‘âŸœIntsÂ¨â€¢FLines â‰ â—¶"21.in"â€¿âŠ‘ â€¢args

p â† l
sc â† 0â€¿0
d â† 1â€¿2â€¿3
i â† {sc â†© (sc+pâ†©(1+10|Â¯1+p++Â´d)âŠ£âŒ¾((2|ğ•©)âŠ¸âŠ‘) p) âŠ£âŒ¾((2|ğ•©)âŠ¸âŠ‘) sc â‹„ dâ†©1+100|Â¯1+ 3+d â‹„ ğ•©+1}â€¢_while_{ğ•Š:Â¬âˆ¨Â´scâ‰¥1000}0
â€¢Show (âŒŠÂ´sc)Ã—3Ã—i

p â†© â‹ˆËœ10â€¿21â¥Š0
s1â€¿s2 â† l-1
p{iâ€¿nğ•Šğ•©: 1âŒ¾(nâ€¿0âŠ‘iâŠ‘âŠ¢) ğ•©}Â´â†© âŸ¨0â€¿s1â‹„1â€¿s2âŸ©
distr â† â‰ Â¨âŠ”âˆ§â¥Š+âŒœÂ´3â¥Š<1+â†•3
w â† 0â€¿0
Step â† {ğ•Š:
  c â† (2|ğ•©  )âŠ‘p
  o â† (2|ğ•©+1)âŠ‘p
  oam â† +Â´â¥Šo
  n â† ((1+â†•âˆ˜â‰ ){(ğ•¨â¥Š0)âˆ¾ğ•©âˆ¾(0â¥ŠËœ10-ğ•¨)}Ë˜âŠ¢) +Â´ distr {ğ•¨Ã—ğ•©âŒ½c}Â¨ -â†•â‰ distr
  w â†© (oam Ã— +Â´â¥Š10â€¿Â¯10â†‘n)âŠ¸+âŒ¾((2|ğ•©)âŠ¸âŠ‘) w
  p (10â€¿21â†‘n)âŒ¾((2|ğ•©)âŠ¸âŠ‘)â†©
  ğ•©+1
}
Stepâ€¢_while_{ğ•Š:Â¬âˆ§Â´âˆ§Â´âˆ˜â¥ŠÂ¨0=p} 0
â€¢Show âŒˆÂ´w
