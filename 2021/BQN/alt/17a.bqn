#!/usr/bin/env bqn
# version doing scalar calculations
âŸ¨RB, B10, Num, Ints, SplitâŸ© â† â€¢Import "../utils.bqn"
l â† âŠ‘â€¢FLines â‰ â—¶"../17.in"â€¿âŠ‘ â€¢args
NInts â† {{'-'=âŠ‘ğ•©?-Num 1â†“ğ•©;Numğ•©}Â¨((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)ğ•©âˆŠ'-'âˆ¾'0'+â†•10)âŠ”ğ•©}
xsâ€¿xeâ€¿ysâ€¿yeâ†NInts l
sâ†xsâ€¿ys
eâ†xeâ€¿ye

Step â† {âŸ¨h â‹„ my â‹„ p â‹„ vâŸ©: vxâ€¿vyâ†v
  np â† p+v
  âŸ¨hâˆ¨âˆ§Â´(npâ‰¥s)âˆ§npâ‰¤e â‹„ myâŒˆ1âŠ‘p â‹„ np â‹„ âŸ¨vx-Ã—vx â‹„ vy-1âŸ©âŸ©
}

Do â† {Stepâ€¢_while_{âŸ¨hâ‹„myâ‹„xâ€¿yâ‹„vâŸ©: (Â¬h)âˆ§yâ‰¥ys} âŸ¨0 â‹„ Â¯âˆ â‹„ 0â€¿0 â‹„ ğ•©âŸ©}

all â† DoÂ¨ â¥Š{(<ğ•©)-â†•1+2Ã—ğ•©} 1+sâŒˆâ—‹|e
ok â† âŠ‘Â¨all
â€¢Show âŒˆÂ´1âŠ‘Â¨ok/all
â€¢Show +Â´ok