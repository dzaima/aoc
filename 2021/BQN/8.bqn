#!/usr/bin/env cbqn
âŸ¨B10, SplitâŸ© â† â€¢Import "../../utils/utils.bqn"
kâ€¿v â† âˆ§Â¨Â¨Â¨<Ë˜â‰>{' ' SplitÂ¨ 2âŠ¸â†“âŒ¾(1âŠ¸âŠ‘)(+`'|'=ğ•©)âŠ”ğ•©}Â¨ â€¢FLines â‰ â—¶"8.in"â€¿âŠ‘ â€¢args

â€¢Show +Â´(â‰ Â¨âˆ¾v)âˆŠ2â€¿3â€¿4â€¿7

â€¢Show +Â´ k {
 n0â€¿n1â€¿n2â€¿n3â€¿n4â€¿n5â€¿n6â€¿n7 â† â‰ Â¨âŠ¸âŠ”ğ•¨ # group patterns by segment count
 âŸ¨d1âŸ© â† n2 # extract ones with only one example per segment count
 âŸ¨d4âŸ© â† n4
 âŸ¨d7âŸ© â† n3
 âŸ¨d8âŸ© â† n7
 
 âŸ¨d3âŸ© â† {âˆ§Â´d1âˆŠğ•©}Â¨âŠ¸/ n5  # '3' is the only 5-segment superset of '1'
 n5(Â¬âˆ˜âˆŠ/âŠ£)â†© â‹ˆd3         # remove '3' from the list of unfinished 5-segment digits
 d9 â† âˆ§â·d3âˆ¾d4           # '9' is '3' & '4' overlapped
 n6(Â¬âˆ˜âˆŠ/âŠ£)â†© â‹ˆd9         # remove '9' from the list of unfinished 6-segment digits
 d2â€¿d5 â† {âˆ§Â´ğ•©âˆŠd9}Â¨âŠ¸âŠ n5 # from '2'&'5', '5' is the only subset of '9'
 d6â€¿d0 â† {âˆ§Â´d1âˆŠğ•©}Â¨âŠ¸âŠ n6 # from '6'&'0', '0' is the only superset of '1'
 ds â† d0â€¿d1â€¿d2â€¿d3â€¿d4â€¿d5â€¿d6â€¿d7â€¿d8â€¿d9 # all the gotten digits
 B10 dsâŠğ•© # look up the wanted numbers, and decode them
}Â¨ v


# lookup tables:
# â€¢Show +Â´ k {
#   d14â†0â€¿2âŠnsâ†(â‹â‰ Â¨ğ•¨)âŠğ•¨
#   B10 ğ•©âŠËœ 8â€¿0â€¿4â€¿6â€¿2â€¿5â€¿7â€¿1â€¿3â€¿9âŠ(â‹4â€¿4â€¿6â€¿2â€¿2â€¿2â€¿0â€¿0â€¿0â€¿6-Ëœ{+Â´âˆ¾ğ•©âŠ¸âˆŠÂ¨d14}Â¨)âŠ¸âŠ ns
# }Â¨ v

# set operations:
# U â† â·âˆ¾ # APL âˆª
# I â† âˆŠ/âŠ£ # APL âˆ©
# W â† Â¬âˆ˜âˆŠ/âŠ£ # APL ~
# 
# â€¢Show +Â´k {
#   ns â† (â‹â‰ Â¨ğ•¨)âŠğ•¨
#   cfâ€¿acfâ€¿bcdfâ€¿n5aâ€¿n5bâ€¿n5câ€¿n6aâ€¿n6bâ€¿n6câ€¿abcdefg â† ns
#   a â† acf W bcdf
#   adg â† n5a I n5b I n5c
#   abfg â† n6a I n6b I n6c
#   ag â† adg I abfg
#   g â† ag W a
#   d â† adg W ag
#   cd â† bcdf W cf
#   b â† cd W d
#   bcef â† abcdefg W adg
#   cef â† bcef W b
#   e â† cef W cf
#   f â† abfg W b U ag
#   c â† abcdefg W abfg U d U e
#   ds â† âˆ§Â¨ âŠâŸœ(aâˆ¾bâˆ¾câˆ¾dâˆ¾eâˆ¾fâˆ¾g)Â¨ "abcefg"â€¿"cf"â€¿"acdeg"â€¿"acdfg"â€¿"bcdf"â€¿"abdfg"â€¿"abdefg"â€¿"acf"â€¿"abcdefg"â€¿"abcdfg"-'a'
#   B10 dsâŠğ•©
# }Â¨ v