#!/usr/bin/env cbqn
âŸ¨SIntsâŸ© â† â€¢Import "utils.bqn"

l â† {{<Ë˜â‰>SIntsÂ¨ğ•©}Â¨ 2â†“Â¨(Â¯1+`0=â‰ Â¨ğ•©)âŠ”ğ•©}âŸ¨âŸ¨âŸ©âŸ©âˆ¾ â€¢FLines â‰ â—¶"19.in"â€¿âŠ‘ â€¢args

Rots â† {
  RotCâ†{xâ€¿y:âŸ¨-yâ‹„xâŸ©}
  fsâ†RotCâŒ¾(1â€¿0â€¿1âŠ¸/)âŸ(â†•4) ğ•©
  (âˆ¾RotCâŒ¾(0â€¿1â€¿1âŠ¸/)âŸ(1â€¿3)Â¨ fs) âˆ¾ âˆ¾RotCâŒ¾(1â€¿1â€¿0âŠ¸/)âŸ(â†•4)Â¨ fs
}


scpos â† âŸ¨0â€¿0â€¿0âŸ©
Correct â† {ağ•Šbr: # assumes left arg is ground truth, and right arg is unknown
  at â† <Ë˜â‰>a
  bd â† {âˆ¾(â‰âˆ˜>ğ•©âŠ¸-)Â¨at}Â¨ br
  dâ†{+Â´Â¬âˆŠğ•©}Â¨ bd
  11=âŒˆÂ´d?
    iâ†âŠ‘dâŠâŒˆÂ´d
    rel â† -(bdcâŠËœâŠ‘âˆ˜âŠâŸœ(âŒˆÂ´)) âŠ’ bdcâ†iâŠ‘bd
    scposâˆ¾â†© âŸ¨relâŸ©
    rel+iâŠ‘br
    ;
  @
}

todo â† RotsÂ¨ 1â†“l
allDone â† âŸ¨âŸ©
{ğ•ŠprevDone:
  newDone â† âŸ¨âŸ©
  todo â†© {ğ•Šb:
    nv â† @ {ağ•Š@:a Correct b; ğ•©}Â´ prevDone
    nvâ‰¢@? newDoneâˆ¾â†© âŸ¨nvâŸ©
          allDoneâˆ¾â†© âŸ¨nvâŸ©
    0;1
  }Â¨âŠ¸/ todo
  newDone
}â€¢_while_{ğ•Š:0â‰ â‰ todo} 1â†‘l

â€¢Show +Â´âˆŠâ‰>âˆ¾Â¨<Ë˜â‰>allDone
â€¢Show âŒˆÂ´+Â´Â¨ â¥Š|-âŒœËœ scpos
