#!/usr/bin/env cbqn
âŸ¨SIntsâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† âŠ‘â€¢FLines â‰ â—¶"17.in"â€¿âŠ‘ â€¢args
xsâ€¿xeâ€¿ysâ€¿yeâ†SInts l
sâ†xsâ€¿ys
eâ†xeâ€¿ye

my â† 0
n â† 0
Step â† {âŸ¨vy0 â‹„ p â‹„ vâŸ©: vxâ€¿vyâ†v
  nxâ€¿ny â† p+â†© v
  done â† âˆ§Â´(pâ‰¥s)âˆ§pâ‰¤e
  myâŒˆÂ´â†© done/vy0
  n+â†© +Â´done
  h â† (Â¬done)âˆ§nyâ‰¥ys
  âŸ¨h/vy0 â‹„ (<h)/Â¨p â‹„ âŸ¨-âŸœÃ— h/vx â‹„ Â¯1 + h/vyâŸ©âŸ©
}

Iota â† {xâ€¿y: âŸ¨y/â†•x â‹„ (xÃ—y)â¥Šâ†•yâŸ©}
Stepâ€¢_while_{Ã—â‰ âŠ‘ğ•©} {xâ€¿y: szâ†âŸ¨x,1+2Ã—yâŸ© â‹„ zâ†0â¥ŠËœÃ—Â´sz â‹„ vâ†xâ€¿y-Iota sz â‹„ âŸ¨1âŠ‘v â‹„ zâ€¿z â‹„ vâŸ©} 1+sâŒˆâ—‹|e
â€¢Show {2Ã·Ëœğ•©Ã—ğ•©+1}my
â€¢Show n