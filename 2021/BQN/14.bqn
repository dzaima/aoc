#!/usr/bin/env cbqn
l â† â€¢FLines â‰ â—¶"14.in"â€¿âŠ‘ â€¢args
chrs â† (âˆŠâŸœ('A'+â†•26))âŠ¸/ â·âˆ¾l # unique characters
w â† â‰ chrs
s â† chrsâŠâŠ‘l # initial state to its indexes

tp â† chrsâŠ¸âŠÂ¨ 2â†‘Â¨ 2â†“l # transformation pattern
tn â† chrsâŠÂ¯1âŠ‘Â¨ 2â†“l # transformation new char index
map â† tnâŒ¾(tpâŠ¸âŠ‘) (Â¯1â¥ŠËœâ‹ˆËœw) # map to the new middle char from the pair given as x/y coords

st0 â† (0â¥ŠËœâ‰¢map) {1âŠ¸+âŒ¾(ğ•¨âŠ¸âŠ‘)ğ•©}Â´ <Ë˜2â†•s # initial state
k â† (âŠ”â¥Š(wÃ—â†•â‰ map) + map) âˆ¾Â¨ âŠ”â¥Š(â†•â‰ map) +â‰1 wÃ—map # which indexes to sum for this one
s0 â† (wâ¥Š0) {1âŠ¸+âŒ¾(ğ•¨âŠ¸âŠ‘)ğ•©}Â´ s # initial state char counts
â€¢ShowÂ¨ 10â€¿40{-Â´Â¯1â€¿0âŠâˆ§ s0+(ğ•¨-1)âŠ‘ğ•©}Â¨ <+`(+Â´Â¨(â¥Šmap)âŠ”âŠ¢)Â¨ {+Â´âˆ˜âŠâŸœğ•©Â¨ k}âŸ(â†•40) â¥Šst0