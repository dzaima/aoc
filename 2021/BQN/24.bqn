#!/usr/bin/env cbqn
âŸ¨SIntâŸ© â† â€¢Import "utils.bqn"
l â† â€¢FLines â‰ â—¶"24.in"â€¿âŠ‘ â€¢args

# guesses a digit at a time, by trying 100â€¦1000 (depending on position) random inputs (with some mutation)

Train â† {
  inpCtr â† 0
  Res â† âŠ¢
  
  _set â† {ğ•¨âŒ¾(ğ•—âŠ¸âŠ‘)ğ•©}
  { ğ•Šins:
    ty â† 3â†‘ins
    v1 â† (4âŠ‘ins)-'w'
    {
      tyâ‰¡"inp"?
        Res â†© (inpCtrâŠ‘âŠ£) v1 _set Res
        inpCtr+â†©1;
      # else
        Div â† (Ã—Ã—âŒŠâˆ˜|)Ã· # alternative funky dzaima/BQN: âŒŠâŒ¾|Ã·
        Mod â† |Ëœ
        op â† (âŠ‘"duioq"âŠ1âŠ‘ty) âŠ‘ +â€¿Ã—â€¿Divâ€¿Modâ€¿=
        {
          (â‰¥âŸœ'w'âˆ§â‰¤âŸœ'z')6âŠ‘ins?
            v2 â† (6âŠ‘ins)-'w'
            Res â†© (((v1âŠ‘âŠ¢) Op v2âŠ‘âŠ¢) v1 _set âŠ¢) Res;
          # else
            n â† SInt 6â†“ins
            Res â†© (((v1âŠ‘âŠ¢) Op N) v1 _set âŠ¢) Res
        }
    }
  }Â¨ğ•©
  3âŠ‘âŠ¢ Res 0â€¿0â€¿0â€¿0Ë™
}

Comp â† {
  inpCtr â† 0
  nlâ†âŸ¨@+10âŸ©
  res â† "{wâ†0â‹„xâ†0â‹„yâ†0â‹„zâ†0"âˆ¾nl
  { ğ•Šins:
    ty â† 3â†‘ins
    v1 â† 4âŠ‘ins
    {
      tyâ‰¡"inp"?
        resâˆ¾â†© âˆ¾âŸ¨v1,"â†©",â€¢Repr inpCtr,"âŠ‘ğ•©",nlâŸ©
        inpCtr+â†©1;
      # else
        op â† (âŠ‘"duioq"âŠ1âŠ‘ty) âŠ‘ "+"â€¿"Ã—"â€¿"((Ã—Ã—âŒŠâˆ˜|)Ã·)"â€¿"|Ëœ"â€¿"="
        {
          (â‰¥âŸœ'w'âˆ§â‰¤âŸœ'z')6âŠ‘ins?
            v2 â† 6âŠ‘ins
            resâˆ¾â†© âˆ¾âŸ¨v1,"â†©",v1,op,v2,nlâŸ©;
          # else
            n â† SInt 6â†“ins
            #Res â†© (((v1âŠ‘âŠ¢) Op N) v1 _set âŠ¢) Res
            resâˆ¾â†© âˆ¾âŸ¨v1,"â†©",v1,op,â€¢Repr n,nlâŸ©
        }
    }
  }Â¨ğ•©
  â€¢BQN âˆ¾âŸ¨res,nl,"z}"âŸ©
}

f â† Comp l
# f â† Train l # alternative compiler


Any â† { # guesses if the prefix ğ•© gives any valid model numbers
  # â€¢Show ğ•© # uncomment for progress display
  initV â† ğ•©
  initL â† â‰ ğ•©
  
  Mut â† {ğ•Ši:
    opt â† â¥Š(1+â†•9) {ğ•¨âŒ¾(ğ•©âŠ¸âŠ‘)i}âŒœ initL+â†•14-initL
    optâŠ‘Ëœ(âŠ‘âŠ¢âŠâŒŠÂ´)FÂ¨ opt
  }
  0 { ğ•¨ğ•Š1:1;ğ•¨ğ•Š0:
    i0 â† initVâˆ¾1+(14-initL)â€¢rand.Range 9
    0â‰¡F 2âŠ‘{sâ€¿Â·â€¿p: âŸ¨s+1â‹„pâ‹„Mut pâŸ©}â€¢_while_{sâ€¿pâ€¿n: (s<20)âˆ§pâ‰¢n} âŸ¨0 â‹„ i0 â‹„ Mut i0âŸ©
  }Â´ â†•initLâŠ‘1000â€¿1000â€¿500â€¿500â€¿500â€¿100â€¿100â€¿100â€¿100â€¿100â€¿100â€¿100â€¿100â€¿100
}

Find â† { ğ•Šorder:
  c â† âŸ¨âŸ©
  {ğ•Š:
    câˆ¾â†© @ {ğ•¨ğ•Š@:Any câˆ¾ğ•¨?ğ•¨;@}âŸ(@â‰¡âŠ¢)Â´ âŒ½order
  }Â¨â†•10
  c âˆ¾ âŠ‘(0=(F câˆ¾âŠ¢)Â¨)âŠ¸/ â¥Šâˆ¾âŒœÂ´4â¥Š<âŒ½order
}

â€¢Out '0'+Find âŒ½1+â†•9
â€¢Out '0'+Find  1+â†•9
