#!/usr/bin/env bqn
âŸ¨_fx_, Tr, MDSlashâŸ© â† â€¢Import "../../utils/utils.bqn"
s â† >'L'=â€¢FLines â‰ â—¶"11.in"â€¿âŠ‘ â€¢args

_run â† { GetCounts _ğ•£ max:
  +Â´â¥Š{ ğ•Šo:
    c â† GetCounts o
    (sâˆ§c<max) âˆ§ oâˆ¨c=0
  }_fx_â‰¢ 0Â¨ s
}

â€¢Show {ğ•©-Ëœ(âŠ¢+Â»Ë˜+Â«Ë˜) (âŠ¢+Â»+Â«)ğ•©}_run 4
zeroPos â† âŠ‘/â¥ŠÂ¬s

ns â† { uâ€¿l: # neighbors
  f1 â† (1-u)âŠ‘Â«â€¿âŠ¢â€¿Â»
  f2 â† (1-l)âŠ‘âŸ¨Â«Ë˜,âŠ¢,Â»Ë˜âŸ©
  yâ€¿x â† (Trâ†•â‰¢s) + ğ•©Ã—Â¨< n-+Â´Â¨Tr âˆ¨` (F1 F2)âŸ(1â†“â†•nâ†âŒŠÂ´â‰¢s) s
  has â† âˆ§Â´(yâ€¿xâ‰¥0)âˆ§yâ€¿x<â‰¢s
  (hasÂ¬âŠ¸Ã— zeroPos) + hasÃ— x + yÃ—1âŠ‘â‰¢s
}Â¨ âˆ¨Â´Â¨âˆ˜|âŠ¸/ â¥ŠÂ¯1+â†•3â€¿3

â€¢Show {+Â´âŠâŸœ(â¥Šğ•©)Â¨ ns}_run 5
