#!/usr/bin/env cbqn
⟨_f_, T, MDSlash⟩ ← •Import "utils.bqn"
s ← >'L'=•FLines ≠◶"11.in"‿⊑ •args

_run ← { GetCounts _𝕣 max:
  +´⥊{ 𝕊o:
    c ← GetCounts o
    (s∧c<max) ∧ o∨c=0
  }_f_≢ 0¨ s
}

•Show {𝕩-˜(⊢+»˘+«˘) (⊢+»+«)𝕩}_run 4
zeroPos ← ⊑/⥊¬s

ns ← { u‿l: # neighbors
  f1 ← (1-u)⊑«‿⊢‿»
  f2 ← (1-l)⊑⟨«˘,⊢,»˘⟩
  y‿x ← (T↕≢s) + 𝕩×¨< n-+´¨T ∨` (F1 F2)⍟(1↓↕n←⌊´≢s) s
  has ← ∧´(y‿x≥0)∧y‿x<≢s
  (has¬⊸× zeroPos) + has× x + y×1⊑≢s
}¨ ∨´¨∘|⊸/ ⥊¯1+↕3‿3

•Show {+´⊏⟜(⥊𝕩)¨ ns}_run 5
