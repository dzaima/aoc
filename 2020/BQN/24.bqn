#!/usr/bin/env cbqn
âŸ¨CountâŸ© â† â€¢Import "utils.bqn"
l â† â€¢FLines â‰ â—¶"24.in"â€¿âŠ‘ â€¢args

#  00â†’â¬¡ â¬¡ â¬¡ x2   nw ne
# y1 â¬¡ â¬¡ â¬¡       w â¬¡ e
#   â¬¡ â¬¡ â¬¡        sw se
#   nw  ne  w e sw se   nn      n n .
# x Â¯1   0 Â¯1 1  0  1   nxn    n x n
# y Â¯1  Â¯1  0 0  1  1    nn   . n n

GetPos â† {
  eâ€¿w â†   ğ•©âŠ¸=Â¨ "ew"
  nâ€¿s â† Â»Â¨ğ•©âŠ¸=Â¨ "ns"
  nâ€¿eâ€¿sâ€¿w /ËœÂ¨â†© <eâˆ¨w
  y â† s-n
  x â† -yâŠ¸â‰ âŠ¸Ã— w-e
  x â‹ˆâ—‹(+Â´) y
}

ps â† GetPosÂ¨ l
psU â† â·ps
on â† 2|psU Count ps

â€¢Show +Â´ on

Show â† {â€¢OutÂ¨ (âŒ½' 'â¥ŠËœÂ¨â†•â‰ ğ•©) âˆ¾Â¨ {â¥Šâ‰' 'Â¨âŠ¸â‰ğ•©}Â¨ <Ë˜ âŠâŸœ"â¬¡â¬¢" ğ•©}
map â† {1Â¨âŒ¾(ğ•©âŠ¸âŠ‘) 0â¥ŠËœ1+âŒˆÂ´ğ•©} {ğ•©-<âŒŠÂ´ğ•©} on/psU

Step â† {
  m â† {ğ•©(âŠ¢âˆ¾âˆ¾)0â¥ŠËœ1âŠ‘â‰¢ğ•©} 0âˆ¾Ë˜ğ•©âˆ¾Ë˜0
  w â† Â«Ë˜m
  c â† m+w
  n â† (w + Â»Ë˜m) + (Â«c) + Â»Ë˜Â»c
  r â† ((Â¬m)âˆ§n=2)  âˆ¨  m âˆ§ (nâ‰ 0)âˆ§nâ‰¤2
  r
}

â€¢Show +Â´â¥Š StepâŸ100 map