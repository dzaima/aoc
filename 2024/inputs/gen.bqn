#!/usr/bin/env bqn
MakeRand â† â€¢MakeRand
âŸ¨MDSlashâŸ© â† â€¢Import "../../utils/utils.bqn"

Join â† {(â‰ ğ•¨)â†“ âˆ¾ ğ•¨âŠ¸âˆ¾Â¨ ğ•©}
Repr â† '-'âŒ¾âŠ‘âŸ('Â¯'=âŠ‘) â€¢Repr

days â† â€¢HashMapËœâŸ¨âŸ©

_gen â† {ğ•© days.Set ğ•—}

_fxRand â† {p â† 10â‹†ğ•©-1 â‹„ p + ğ•¨ ğ•—.Range 9Ã—p} # ğ•©-digit numbers, no leading zeroes

_retryThis â† {ğ•¨ğ”½{ğ•¨ğ”½ğ•˜}ğ•© â€¢_while_(â‰¡âŸœretry) retry} # retry ğ•¨ğ”½ğ•© until result isn't retry

{ ğ•Šr:
  n â† ScaleF 1000
  n2 â† nÃ—2
  {(âŠ£âˆ¾"   "âˆ¾âŠ¢)Â´ReprÂ¨ğ•©}Â¨ <Ë˜ nâ€¿2â¥Š (n2 r.Range n2) âŠ n2 r _fxRand ScaleD 5
} _gen 1

{ ğ•Šr:
  n â† ScaleF 1000
  vs â† (n r.Range 2) -âˆ˜âŠ¢âŸâŠ£Â¨ (5+ n r.Range 4) {
    l â† +` ğ•¨ r.Range 4
    o â† r.Range 3âŒŠâ‰ l
    l (Â¯10+20 r.RangeËœâ‰ )âŠ¸+âŒ¾((o r.Deal â‰ l)âŠ¸âŠ)â†©
    l
  }Â¨ n
  vs {{ğ•© + r.Range 99-âŒˆÂ´ğ•©} ğ•©-âŒŠÂ´ğ•©}Â¨â†©
  {' 'Join ReprÂ¨ ğ•©}Â¨ vs
} _gen 2

{ ğ•Šr:
  n â† ScaleF 17800
  l â† (n r.Range â‰ )âŠ¸âŠ "![]%^&*()_+muldon't()"
  Sprinkle â† {l ğ•©âŒ¾((â‰ ğ•©)â†‘(r.Range (â‰ l)-â‰ ğ•©)â†“âŠ¢)â†© â‹„ 1}Â¨
  Sprinkle {ğ•Š: aâ€¿bâ†2 r.Range 1000 â‹„ âˆ¾âŸ¨"mul(", Repr a, ",", Repr b, ")"âŸ©}Â¨ â†•âŒŠnÃ·15
  Sprinkle (âŒŠnÃ·600)â¥Š<"do()"
  Sprinkle (âŒŠnÃ·600)â¥Š<"don't()"
  l (@+10)Â¨âŒ¾(((âŒŠ0.5+ nÃ·3500) r.Deal â‰ l)âŠ¸âŠ)â†©
  l
} _gen 3

{ ğ•Šr:
  n â† ScaleF 140
  pts â† âŒ½âˆ˜â‰âŸ(â†•4) â‰"XMAS"
  ptsâˆ¾â†© {âŒ½Ë˜Â¨âŠ¸âˆ¾ âŒ½âŠ¸â‹ˆ ğ•©} 4â€¿4â¥Šâˆ¾âˆ¾âŸœ"...."Â¨ "XMAS"
  ptsâˆ¾â†© âŒ½âˆ˜â‰âŸ(â†•4) ["M.S",".A.","M.S"]
  m â† "XMAS" âŠËœ nâ€¿n r.Range 4
  pti â† {MDSlash ğ•©â‰ '.'}Â¨ pts
  ptc â† pti âŠ‘Â¨ pts
  ptr â† n- âŒˆÂ´Â¨ pti
  {
    m (ğ•©âŠ‘ptc)âŒ¾(((r.RangeÂ¨ ğ•©âŠ‘ptr)âŠ¸+Â¨ ğ•©âŠ‘pti)âŠ¸âŠ‘)â†©
    1
  }Â¨ (âŒŠÃ—Ëœn) r.Range â‰ pts
  m
} _gen 4

{ ğ•Šr:
  nodes â† âŒˆâŒ¾(Ã·âŸœ4) 24âŒˆ ScaleF 100
  tests â† ScaleD âŒŠnodesÃ—1.85
  
  q â† nodesÃ·4
  conn â† nodesâ€¿nodesâ¥Š0
  
  qs â† âŸ¨
    âŸ¨nodes-q-2, nodes-q-1âŸ©âŠ¸+Â¨ â†•q-2
    âŸ¨nodes-q+1, nodes-qâŸ©âŠ¸+Â¨ - â†•q-1
    âŒ½âŸ¨nodes-q, nodes-q-1âŸ©âŠ¸+Â¨ -âŠ¸â‹ˆÂ¨ â†•q-1
    âŒ½âŸ¨nodes-q-1, nodes-q+1âŸ©âŠ¸+Â¨ â‹ˆâŸœ-Â¨ â†•q-1
  âŸ©
  {
    yâ€¿x â† <Ë˜â‰>ğ•©
    conn 1Â¨âŒ¾((âˆ¾ y â‹ˆÂ¨Â¨ 1â†“â†‘x)âŠ¸âŠ‘)â†©
    1
  }Â¨ qs
  
  t â† { ğ•Š:
    qc â† (2+r.Range 2) âŠ‘ qs # I have no clue what happens with the other two quadrants
    k â† 1+2Ã— 2+ r.Range Â¯2+âŒŠqÃ·2
    is â† k r.Subset â‰ qc
    r.Dealâˆ˜â‰ âŠ¸âŠâŸ(r.Range 2) âŠ‘Â¨isâŠqc
  }Â¨ â†•tests
  
  d â† MDSlash conn
  
  nlâ†âŒŠnodesÃ·10
  shuf â† (â†•nl) âˆ¾ nl+r.Deal nodes-nl
  dâ€¿t âŠâŸœshufÂ¨Â¨â†©
  dâ€¿t r.Dealâˆ˜â‰ âŠ¸âŠÂ¨â†©
  
  ({'|'Join ReprÂ¨ğ•©}Â¨ d) âˆ¾âŸ¨âŸ¨âŸ©âŸ©âˆ¾ (','Join ReprÂ¨)Â¨ t
} _gen 5

{ ğ•Šr:
  ds â† (âŒ½-âŒ¾âŠ‘)âŸ(â†•4) Â¯1â€¿0
  
  w â† ScaleF 130
  cn â† Ã—Ëœw
  wa â† âŒˆ 0.05 Ã— cn # target wall amount
  p â† 1+2 r.Range w-2
  m â† wâ€¿wâ¥Š0 # 0:air/any/todo 1:wall 2:start 4:reqair
  m 2âŒ¾(pâŠ¸âŠ‘)â†©
  tgtSteps â† âŒˆ1.2Ã—w
  remaining â† tgtSteps
  tryLeft â† remainingÃ—20
  dir â† 0
  { ğ•Š:
    d â† dirâŠ‘ds
    l â† 2+r.Range w
    pe â† p + dÃ—l
    pw â† pe+d
    âˆ§Â´pwâ‰¥0? âˆ§Â´pw<w?
    0=peâŠ‘m?
    1â‰¥pwâŠ‘m?
    path â† (p + dÃ—âŠ¢)Â¨ â†•l+1
    âˆ§Â´1â‰ pathâŠ‘m?
    {0:1;
      path2 â† (âˆ§Â´â‰¥âŸœ0âˆ§<âŸœw)Â¨âŠ¸/ (pe + ((4|dir+1)âŠ‘ds)Ã—âŠ¢)Â¨ â†•w
      ok â† âˆ§Â´ (path2âŠ‘m)âˆŠ 0â€¿2â€¿4
      {ğ•Š: 1âŠ£m 4Â¨âŒ¾(path2âŠ¸âŠ‘)â†©} âŸâŠ¢ ok
      ok
    } remaining=1?
    m (4Ã—0=âŠ¢)âŠ¸+âŒ¾(pathâŠ¸âŠ‘)â†©
    m 1âŒ¾(pwâŠ¸âŠ‘) â†©
    p â†© pe
    dir â†© 4|dir+1
    remaining-â†©1
  ;
    0
  }â€¢_while_{ğ•Š: (0â‰¤tryLeft-â†©1) âˆ§ remainingâ‰ 0} @
  
  # â€¢Show tgtStepsâ€¿remainingâ€¿tryLeft
  remaining = 0?
  # m 3âŒ¾(pâŠ¸âŠ‘)â†©
  # â€¢Show mâŠ"Â·#^â•â€¢"
  m â†© {(â‰ ğ•©)â†‘/â¼ ((âŒŠ0.5Ã—â‰ ğ•©) âŒŠ 0âŒˆ wa - +Â´1=â¥Šm)r.Deal â‰ ğ•©}âŒ¾((0=m)/â—‹â¥ŠâŠ¢) m
  # â€¢Show mdâŠ"âˆ§>âˆ¨<Â·"
  ".#^"âŠËœ4|m
  ; retry
} _gen 6

{ ğ•Šr:
  n â† ScaleF 850
  distr â† +`(âŠ¢Ã·+Â´) 0â€¿0â€¿5â€¿5â€¿50â€¿25â€¿25â€¿20â€¿20â€¿20â€¿10â€¿10
  
  sum â† 0
  _gen â† {
    _try_ â† { ğ”½_ğ•£_ğ•˜ @:
      ops â† (ğ•˜ r.Range â‰ ğ•—) âŠ ğ•—
      args â† 1+ğ•˜ r.Range 99
      start â† 1+r.Range 999
      exp â† start {opâ€¿argğ•Šğ•©: ğ•© Op arg}Â´ âŒ½opsâ‹ˆÂ¨args
      exp<1e14?
      sum+â†© exp
      expâˆ¾startâˆ¾args
      ;@
    }
    ğ•— _try_ ğ•© â€¢_while_ (@âŠ¸â‰¡) @
  }
  
  ts â† {ğ•Š: 0âŒˆÂ¯1+r.Range 4}â—¶âŸ¨
    {(1+r.Range 2â‹†30+r.Range 20) âˆ¾ 1+ r.RangeÂ¨ Â¯1+ (1+ğ•©)â¥Š10â‹†1+r.Range 3}
    +â€¿Ã— _gen
    +â€¿Ã—â€¿{(ğ•¨ Ã— 10â‹†â‰ â€¢Reprğ•©) + ğ•©} _gen
  âŸ©Â¨ distr â‹ n r.Range 0
  
  sum<1e15?
  {âˆ¾âŸ¨ReprâŠ‘ğ•©, ": ", ' 'Join ReprÂ¨ 1â†“ğ•©âŸ©}Â¨ ts
  ; retry
} _gen 7

{ ğ•Šr:
  n â† ScaleF 50
  res â† nâ€¿nâ¥Š'.'
  chars â† (((âŒˆnÃ—1.04)âŒŠâ‰ ) r.Deal â‰ )âŠ¸âŠ âˆ¾"0Aa"+âŸœâ†•Â¨10â€¿26â€¿26
  { ğ•Š char:
    { ğ•Š:
      is â† 4 r.Deal nÃ—n
      âˆ§Â´'.'= isâŠâ¥Šres?
        1=âŒˆÂ´ â¥Š â€¢math.GCDÂ´ |-âŒœËœÂ¨ n(|â‹ˆâŒŠâˆ˜Ã·Ëœ)is?
          res charÂ¨âŒ¾(isâŠâ¥Š)â†©
          0
      ; 1
    }â€¢_while_âŠ¢ 1
  }Â¨ chars
  '.'â‰¡âŠ‘res?
  res
  ; retry
} _gen 8

{ ğ•Šr:
  n â† ScaleF 10000
  lâ†Â¯1â†“â¥Š(1+n r.Range 9) â‰Ë˜ n r.Range 10
  
  fs â† l / (â‰ l)â†‘ â¥Š (â†•n+1)â‰Ë˜Â¯1
  gs â† 2â†‘((+`âŒ¾âŒ½âˆ˜Â¬ > +`) fs=Â¯1) âŠ” fs
  âˆ§Â´Ã—â‰ Â¨gs?
  âˆ§Â´Â¯1â‰  {(âŠ‘ğ•¨)â‹ˆÂ¯1âŠ‘ğ•©}Â´gs? # a property that was true in my input and 9_orig.bqn requires, but some inputs violate it
  
  â‹ˆ'0'+l
  ; retry
} _gen 9

{ ğ•Šr:
  ds â† âŒ½Â¨âŠ¸âˆ¾ 0âŠ¸â‹ˆÂ¨ 1â€¿Â¯1
  n â† ScaleF 47
  mâ†nâ€¿n r.Range 10
  { ğ•Š:
    ps â† (<2 r.Range n) +`(10 r.Range 4)âŠds
    âˆ§Â´(âˆ§Â´â‰¥âŸœ0âˆ§<âŸœn)Â¨ ps? psâ‰¡â·ps?
      m (â†•10)âŒ¾(psâŠ¸âŠ‘)â†©
      1
    ;0
  }Â¨ â†•nÃ—nÃ—100
  '0'+<Ë˜m
} _gen 10

{ ğ•Šr:
  n â† ScaleF 8
  vs â† 0 âˆ¾ r _fxRandÂ¨ 7âŒŠ1+â†•n-1
  ' 'Join ReprÂ¨ vs
} _gen 11

{ ğ•Šr:
  n â† ScaleF 140
  m â† nâ€¿nâ¥Šr.Range 26
  any â† 0Â¨ m
  ds â† -âŠ¸âˆ¾ âŒ½âŠ¸â‹ˆ 0â€¿1
  { ğ•Š:
    s â† n (|â‹ˆËœâŒŠâˆ˜Ã·Ëœ) r.Rangeâˆ˜â‰ âŠ¸âŠ‘ /Â¬â¥Šany
    ps â† {(âˆ§Â´â‰¥âŸœ0âˆ§<âŸœn)Â¨âŠ¸/ â· ğ•© âˆ¾ (0=(âŒˆ0.01Ã—â‰ )r.RangeËœâ‰ )âŠ¸/ â¥Šğ•©+âŒœds}âŸ(r.Range âŒˆâˆšn) â‹ˆs
    m (r.Range 26)Â¨âŒ¾(psâŠ¸âŠ‘) â†©
    any 1Â¨âŒ¾(psâŠ¸âŠ‘)â†©
    1
  }Â¨ â†•nÃ—2
  # m (26 r.RangeËœâ‰ )âŒ¾((<Ë˜ â·nâ€¿2 r.Range n)âŠ¸âŠ‘)â†©
  'A'+m
} _gen 12

{ ğ•Šr:
  n â† ScaleF 320
  Check â† { aâ€¿bâ€¿r:
    ah â† -Â´ rÃ—âŒ½b
    al â† -Â´ aÃ—âŒ½b
    0=al|ah?
    an â† ahÃ·al
    bh â† (âŠ‘r) - anÃ—âŠ‘a
    bl â† âŠ‘b
    0=bl|bh?
    (3Ã—an) + bhÃ·bl
    ; 0
  }
  
  Â¯1â†“âˆ¾{ ğ•Šğ•©:
    a â† 2 r _fxRand 2
    b â† 2 r _fxRand 2
    â‰ Â´aÃ·b?
    ns â† 1+ 2 r.Range 99
    { ğ•Š:
      an â† (-Â´ 1e13Ã—âŒ½b) Ã· -Â´ aÃ—âŒ½b
      bn â† (1e13 - anÃ—âŠ‘a) Ã· âŠ‘b
      ns+â†© âŒˆanâ€¿bn
    }âŸâŠ¢ ğ•©
    âˆ§Â´ns>0?
    r â† (+Â´nsÃ—aâ€¿b) - 1e13Ã—ğ•©
    (ğ•©âŠ‘âŸ¨0â€¿1,1â€¿0âŸ©) â‰¡ 0=CheckÂ¨ âŸ¨aâ€¿bâ€¿r, âŸ¨a,b,r+1e13âŸ©âŸ©? # check to make sure part1-intended or part2-intended doesn't happen to be valid for the other part, which could result in negative numbers
    âŸ¨
      {âˆ¾âŸ¨"Button A: X+",ğ•¨,", Y+",ğ•©âŸ©}Â´ ReprÂ¨ a
      {âˆ¾âŸ¨"Button B: X+",ğ•¨,", Y+",ğ•©âŸ©}Â´ ReprÂ¨ b
      {âˆ¾âŸ¨"Prize: X=",ğ•¨,", Y=",ğ•©âŸ©}Â´ ReprÂ¨ r
      âŸ¨âŸ©
    âŸ©
    ; retry
  }_retryThis Â¨ nâ†‘ /â¼ (nÃ·2) r.Deal n
} _gen 13

{ ğ•Šr:
  n â† ScaleF 500
  sz â† 103â€¿101
  tree â† [
    "###############################"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·###Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#####Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#######Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#########Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#####Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#######Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#########Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·###########Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·#############Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#########Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·###########Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·#############Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·###############Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·#################Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·#############Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·###############Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·#################Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·###################Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·#####################Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·###Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·###Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·###Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "#Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·#"
    "###############################"
  ] = '#'
  treePos â† r.RangeÂ¨ 1+sz-â‰¢tree # top-left of tree location
  mapP2 â† (2+tree)âŒ¾((â‰¢tree)â†‘treePosâ†“âŠ¢) szâ¥Š0
  mapP2 {ğ•©â†‘ /â¼ (n-+Â´â¥Štree) r.Deal ğ•©}âˆ˜â‰  âŒ¾((mapP2=0)âŠ¸(/â—‹â¥Š)) â†©
  # â€¢Show mapP2âŠ"Â·#_â•"
  psP2 â† MDSlash 2|mapP2
  psP2 r.Dealâˆ˜â‰ âŠ¸âŠâ†©
  tgtP2 â† 8000+r.Range 300
  vs â† <Ë˜ â‰¥âŸœ0âŠ¸+ Â¯99+ nâ€¿2 r.Range 198
  ps â† szâŠ¸|Â¨ psP2 - vsÃ—tgtP2
  ps {âˆ¾âŸ¨"p=",ğ•¨," v=",ğ•©âŸ©}â—‹(','Join ReprÂ¨âˆ˜âŒ½)Â¨ vs
} _gen 14

{ ğ•Šr:
  w â† ScaleF 50
  rq â† ScaleF wÃ—wÃ—8
  
  cn â† Ã—Ëœcwâ†w-2
  k â† r.Dealâˆ˜â‰ âŠ¸âŠ / -âŸœÂ» 1âˆ¾-âŸœ1âŒ¾âŠ‘ âŒŠcn Ã— 1âŒ¾(Â¯1âŠ¸âŠ‘) +`0.65â€¿0.25â€¿0.10
  b â† âˆ¾âŸœ3Ë˜ 3âˆ¾Ë˜ 3Â¨âˆ˜âŠâŠ¸(âˆ¾âˆ¾âŠ£) cwâ€¿cwâ¥Šk
  b âŠâŸœ"@.O#"â†©
  rqs â† {ğ•©âŠ”ËœâŒŠ1000Ã·Ëœâ†•â‰ ğ•©} (rq r.Range 4)âŠ"><^v"
  (<Ë˜b) âˆ¾ âŸ¨âŸ¨âŸ©âŸ© âˆ¾ rqs
} _gen 15

{ ğ•Šr:
  cnâ†â‰ chars â† "wubrg"
  pn â† 440
  dn â† ScaleF 400
  Distr â† {-âŸœÂ»âŒŠ0.5+ğ•¨Ã— 1âŒ¾(Â¯1âŠ¸âŠ‘) +`(âŠ¢Ã·+Â´)ğ•©}
  o1 â† (r.Range cn) âŠ‘ chars
  ps1 â† â¥ŠÂ¨ o1âŠ¸â‰ âŠ¸/ chars
  ps2 â† âˆ¾2â†“Â¨{âˆ¨Â´Â¨ o1=ğ•©}âŠ¸âŠ” â¥ŠâŠâŸœcharsÂ¨ â†•cnâ€¿cn
  ps3â† {âˆ§Â´(ğ•©â‰ o1) âˆ¨ âˆ¨Â´(0âŠ¸âˆ¾âˆ¨âˆ¾âŸœ0)Â¨ â·âŸœğ•©Â¨ ps2}Â¨âŠ¸/ âŠâŸœcharsÂ¨ â¥Šâ†•3â¥Šcn
  ps â† âˆ¾ps1â€¿ps2â€¿ps3 âˆ¾ (4+â†•5) {
    <Ë˜ âŠâŸœchars â‰>cn| âŒŠâˆ˜Ã·âŸœcnâŸ(â†•ğ•¨) ğ•© r.Deal cnâ‹†ğ•¨
  }Â¨ pn Distr 1â†“120-20Ã—â†•6
  ds â† {
    p â† chars âŠËœ ğ•© r.Range 5
    p
  }Â¨ +Ë 20+2â€¿dn r.Range 11
  â€¢Show 1
  âŸ¨", "Join r.Dealâˆ˜â‰ âŠ¸âŠ psâŸ©âˆ¾âŸ¨âŸ¨âŸ©âŸ©âˆ¾ds
} _gen 19

{ ğ•Šr:
  n â† ScaleF 5
  l â† ScaleF 3
  ('0'+nâ€¿l r.Range 10)âˆ¾Ë˜'A'
} _gen 21

{ ğ•Šr:
  n â† ScaleF 1750
  ReprÂ¨ n r.Range 16777216
} _gen 22

# { ğ•Šr:
# } _gen

ScaleD â† !
ScaleF â† !
retry â† {â‡}
{
  args â† â€¢args
  Arg â† {ğ•Š: (argsâ†“Ëœâ†©1) âŠ¢ (1âŒŠâ‰ )âŠ¸â†‘args}
  path â† â‹ˆâ¼ Arg@
  day â† â€¢ParseFloat (âˆ§`('0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'))âŠ¸/ â€¢file.Name path
  seed â† â‰ â—¶âŸ¨1, ("u"âŠ¸â‰¡â—¶âŸ¨â€¢ParseFloat, {ğ•Š: sâ†â€¢rand.Range 1e9 â‹„ â€¢Out "Seed: "âˆ¾â€¢Repr s â‹„ s}âŸ©)âŠ‘âŸ© Arg@
  ScaleD â†© ArgâŠ¸{âŸ¨âŸ©ğ•Šğ•©: ğ•©; âŸ¨aâŸ©ğ•Šğ•©: â€¢ParseFloat a}
  ScaleF â†© ArgâŠ¸{âŸ¨âŸ©ğ•Šğ•©: ğ•©; âŸ¨aâŸ©ğ•Šğ•©: mâ†'x'=Â¯1âŠ‘a â‹„ ğ•©âŠ¸Ã—âŸm â€¢ParseFloat m-âŠ¸â†“a}

  f â† days.Get day
  rng â† MakeRand seed
  rn â† 0
  args0 â† args
  res â† {ğ•Š: argsâ†©args0 â‹„ rn+â†©1 â‹„ F rng}â€¢_while_ (retryâŠ¸â‰¡) retry
  {â€¢Out âˆ¾âŸ¨path, ": ", â€¢Repr ğ•©, " retries"âŸ©}âŸ(1âŠ¸â‰ ) rn
  path â€¢FLines â‹ˆâŸ(2=â€¢Typeâˆ˜âŠ‘) <Ë˜âŸ(2==) res
}