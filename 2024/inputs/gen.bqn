#!/usr/bin/env bqn
MakeRand â† â€¢MakeRand
âŸ¨MDSlashâŸ© â† â€¢Import "../../utils/utils.bqn"

Join â† {(â‰ ğ•¨)â†“ âˆ¾ ğ•¨âŠ¸âˆ¾Â¨ ğ•©}
Repr â† '-'âŒ¾âŠ‘âŸ('Â¯'=âŠ‘) â€¢Repr

days â† â€¢HashMapËœâŸ¨âŸ©

_gen â† {ğ•© days.Set ğ•—}

_fxRand â† {p â† 10â‹†ğ•©-1 â‹„ p + ğ•¨ ğ•—.Range 9Ã—p} # ğ•©-digit numbers, no leading zeroes

{ ğ•Šr:
  n â† ScaleF 1000
  n2 â† nÃ—2
  {(âŠ£âˆ¾"   "âˆ¾âŠ¢)Â´ReprÂ¨ğ•©}Â¨ <Ë˜ nâ€¿2â¥Š (n2 r.Range n2) âŠ n2 r _fxRand ScaleD 5
} _gen 1

{ ğ•Šr:
  n â† ScaleF 1000
  vs â† (n r.Range 2) -âˆ˜âŠ¢âŸâŠ£Â¨ (5+ n r.Range 4) {
    l â† +` ğ•¨ r.Range 4
    o â† r.Range 3âŒŠâ‰ l
    l (Â¯10+20 r.RangeËœâ‰ )âŠ¸+âŒ¾((o r.Deal â‰ l)âŠ¸âŠ)â†©
    l
  }Â¨ n
  vs {{ğ•© + r.Range 99-âŒˆÂ´ğ•©} ğ•©-âŒŠÂ´ğ•©}Â¨â†©
  {' 'Join ReprÂ¨ ğ•©}Â¨ vs
} _gen 2

{ ğ•Šr:
  n â† ScaleF 17800
  l â† (n r.Range â‰ )âŠ¸âŠ "![]%^&*()_+muldon't()"
  Sprinkle â† {l ğ•©âŒ¾((â‰ ğ•©)â†‘(r.Range (â‰ l)-â‰ ğ•©)â†“âŠ¢)â†© â‹„ 1}Â¨
  Sprinkle {ğ•Š: aâ€¿bâ†2 r.Range 1000 â‹„ âˆ¾âŸ¨"mul(", Repr a, ",", Repr b, ")"âŸ©}Â¨ â†•âŒŠnÃ·15
  Sprinkle (âŒŠnÃ·600)â¥Š<"do()"
  Sprinkle (âŒŠnÃ·600)â¥Š<"don't()"
  l (@+10)Â¨âŒ¾(((âŒŠ0.5+ nÃ·3500) r.Deal â‰ l)âŠ¸âŠ)â†©
  lâˆ¾@+10
} _gen 3

{ ğ•Šr:
  n â† ScaleF 140
  pts â† âŒ½âˆ˜â‰âŸ(â†•4) â‰"XMAS"
  ptsâˆ¾â†© {âŒ½Ë˜Â¨âŠ¸âˆ¾ âŒ½âŠ¸â‹ˆ ğ•©} 4â€¿4â¥Šâˆ¾âˆ¾âŸœ"...."Â¨ "XMAS"
  ptsâˆ¾â†© âŒ½âˆ˜â‰âŸ(â†•4) ["M.S",".A.","M.S"]
  m â† "XMAS" âŠËœ nâ€¿n r.Range 4
  pti â† {MDSlash ğ•©â‰ '.'}Â¨ pts
  ptc â† pti âŠ‘Â¨ pts
  ptr â† n- âŒˆÂ´Â¨ pti
  {
    m (ğ•©âŠ‘ptc)âŒ¾(((r.RangeÂ¨ ğ•©âŠ‘ptr)âŠ¸+Â¨ ğ•©âŠ‘pti)âŠ¸âŠ‘)â†©
    1
  }Â¨ (âŒŠÃ—Ëœn) r.Range â‰ pts
  m
} _gen 4

{ ğ•Šr:
  nodes â† âŒˆâŒ¾(Ã·âŸœ4) 24âŒˆ ScaleF 100
  tests â† ScaleD âŒŠnodesÃ—1.85
  
  q â† nodesÃ·4
  conn â† nodesâ€¿nodesâ¥Š0
  
  qs â† âŸ¨
    âŸ¨nodes-q-2, nodes-q-1âŸ©âŠ¸+Â¨ â†•q-2
    âŸ¨nodes-q+1, nodes-qâŸ©âŠ¸+Â¨ - â†•q-1
    âŒ½âŸ¨nodes-q, nodes-q-1âŸ©âŠ¸+Â¨ -âŠ¸â‹ˆÂ¨ â†•q-1
    âŒ½âŸ¨nodes-q-1, nodes-q+1âŸ©âŠ¸+Â¨ â‹ˆâŸœ-Â¨ â†•q-1
  âŸ©
  {
    yâ€¿x â† <Ë˜â‰>ğ•©
    conn 1Â¨âŒ¾((âˆ¾ y â‹ˆÂ¨Â¨ 1â†“â†‘x)âŠ¸âŠ‘)â†©
    1
  }Â¨ qs
  
  t â† { ğ•Š:
    qc â† (2+r.Range 2) âŠ‘ qs # I have no clue what happens with the other two quadrants
    k â† 1+2Ã— 2+ r.Range Â¯2+âŒŠqÃ·2
    is â† k r.Subset â‰ qc
    r.Dealâˆ˜â‰ âŠ¸âŠâŸ(r.Range 2) âŠ‘Â¨isâŠqc
  }Â¨ â†•tests
  
  d â† MDSlash conn
  
  nlâ†âŒŠnodesÃ·10
  shuf â† (â†•nl) âˆ¾ nl+r.Deal nodes-nl
  dâ€¿t âŠâŸœshufÂ¨Â¨â†©
  dâ€¿t r.Dealâˆ˜â‰ âŠ¸âŠÂ¨â†©
  
  ({'|'Join ReprÂ¨ğ•©}Â¨ d)âˆ¾âŸ¨âŸ¨âŸ©âŸ©âˆ¾ (','Join ReprÂ¨)Â¨ t
} _gen 5

# { ğ•Šr:
# } _gen

ScaleD â† !
ScaleF â† !
{
  args â† â€¢args
  Arg â† {ğ•Š: (argsâ†“Ëœâ†©1) âŠ¢ (1âŒŠâ‰ )âŠ¸â†‘args}
  path â† â‹ˆâ¼ Arg@
  day â† â€¢ParseFloat (âˆ§`('0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'))âŠ¸/ â€¢file.Name path
  seed â† â‰ â—¶âŸ¨1, ("u"âŠ¸â‰¡â—¶âŸ¨â€¢ParseFloat, {ğ•Š: â€¢rand.Range 1e9}âŸ©)âŠ‘âŸ© Arg@
  ScaleD â†© ArgâŠ¸{âŸ¨âŸ©ğ•Šğ•©: ğ•©; âŸ¨aâŸ©ğ•Šğ•©: â€¢ParseFloat a}
  ScaleF â†© ArgâŠ¸{âŸ¨âŸ©ğ•Šğ•©: ğ•©; âŸ¨aâŸ©ğ•Šğ•©: mâ†'x'=Â¯1âŠ‘a â‹„ ğ•©âŠ¸Ã—âŸm â€¢ParseFloat m-âŠ¸â†“a}

  path (0=â€¢Typeâˆ˜âŠ‘)âˆ˜âŠ¢â—¶â€¢FCharsâ€¿â€¢FLines <Ë˜âŸ(2==) {ğ• MakeRand seed} days.Get day
}