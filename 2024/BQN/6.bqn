#!/usr/bin/env bqn
âŸ¨MDSlash, _underSelect_, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† >â€¢FLines 2024â€¿6 Input â€¢args

w â† l='#'
n â† â‰ l
p0 â† 0 â‹ˆ â‹ˆâ¼MDSlash l='^'

ds â† (âŒ½-âŒ¾âŠ‘)âŸ(â†•4) Â¯1â€¿0

vâ†â€¢HashMapËœâŸ¨âŸ©
G â† { part1 ğ•Š w:
  v.DeleteÂ¨ v.Keys@
  wr â† <Ë˜âˆ˜â‰Â¨ â‰âˆ˜âŒ½âŸ(â†•4) âŒ½w
  m â† 0Â¨ l
  S â† {
    0 v.Get ğ•©? 1;
    dâ€¿p:
      ğ•© v.Set 1
      y2â€¿x2 â† ((n-1)âŠ¸-âŒ¾âŠ‘âŒ½)âŸd p
      forward â† (-y2)â†‘x2âŠ‘dâŠ‘wr
      steps â† âŠ‘forwardâŠ1
      dc â† dâŠ‘ds
      {ğ•Š: m 1Â¨ _underSelect_ (p + dc Ã—âŒœ â†•steps+1) â†©}âŸâŠ¢ part1
      
      steps â‰  â‰ forward?
      âŸ¨4|1+d, p + stepsÃ—dcâŸ©
    ;
      0
  }
  st â† Sâ€¢_while_(1==) p0
  
  stâ€¿m
}
# ! 0=âŠ‘G w
m0 â† 1âŠ‘ 1 G w
â€¢Show +Â´â¥Š m0
â€¢Show +Â´ {âŠ‘0 G 1âŒ¾(ğ•©âŠ¸âŠ‘) w}Â¨ MDSlash m0
