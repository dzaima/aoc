#!/usr/bin/env bqn
âŸ¨MDSlash, _underSelect_, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† >â€¢FLines 2024â€¿6 Input â€¢args

n â† â‰ l
w â† l='#'
p0 â† 0 â‹ˆ â‹ˆâ¼MDSlash l='^'

nd â† n-1
RotPos â† âŠ£â—¶âŸ¨âŠ¢, (âŠ£â‹ˆËœnd-âŠ¢)Â´âŠ¢, ndâŠ¸-, (âŠ¢â‹ˆnd-âŠ£)Â´âŠ¢âŸ©

ds â† (âŒ½-âŒ¾âŠ‘)âŸ(â†•4) Â¯1â€¿0

mz â† 0Â¨ l
v â† â€¢HashMapËœâŸ¨âŸ©
G â† { part1 ğ•Š wr:
  m â† mz
  S â† {
    0 v.Get ğ•©? 1;
    dâ€¿p:
      ğ•© v.Set 1
      y2â€¿x2 â† d RotPos p
      forward â† (-y2)â†‘x2âŠ‘dâŠ‘wr
      steps â† âŠ‘forwardâŠ1
      dc â† dâŠ‘ds
      {ğ•Š: m 1Â¨ _underSelect_ (p + dc Ã—âŒœ â†•steps+1) â†©}âŸâŠ¢ part1
      
      steps â‰  â‰ forward?
      âŸ¨4|1+d, p + stepsÃ—dcâŸ©
    ;
      0
  }
  st â† Sâ€¢_while_(1==) p0
  v.DeleteÂ¨ v.Keys@
  stâ€¿m
}
# ! 0=âŠ‘G w

wr â† <Ë˜Â¨ Â¯1âŒ½ âŒ½âˆ˜â‰âŸ(â†•4) w
m0 â† 1âŠ‘ 1 G wr
â€¢Show +Â´â¥Š m0
â€¢Show +Â´ {
  âŠ‘ 0 G (RotPosâŸœğ•©Â¨ Â¯1âŒ½â†•4) {xâ€¿yğ•Šğ•©: 1âŒ¾(yâŠ‘xâŠ‘âŠ¢)ğ•©}Â¨ wr
}Â¨ MDSlash m0
