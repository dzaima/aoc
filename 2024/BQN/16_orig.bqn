#!/usr/bin/env bqn
âŸ¨RB, B10, Num, Repr, LCM, GCD, Ints, SInts, Split, SplitF, Indices, ReIndex, MDSlash, MDSlashI, Unjoin, Count, _fx_, _fi_, _underSelect_, Select, Tr, TW, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† >â€¢FLines 2024â€¿16 Input â€¢args
wâ†l='#'
zâ†Â¯1000000
# â€¢Show l
â€¢Show bestâ†â‹ˆâ¼âŒŠÂ´-z-(<l='E') /â—‹â¥ŠÂ¨ qâ†{
  (Â¬w)âŠ¸Ã—Â¨ ({âŒŠÂ´âŸ¨1âŠ¸âŒ½ğ•©,Â¯1âŠ¸âŒ½ğ•©âŸ©}ğ•©+1000) âŒŠ ğ•©âŒŠâŸ¨Â»,Â»Ë˜,Â«,Â«Ë˜âŸ©{ğ•ğ•©}Â¨ğ•©+1
}_fx_â‰¢ {âŸ¨0Â¨ğ•©,ğ•©,0Â¨ğ•©,0Â¨ğ•©âŸ©} âŠâŸœ0â€¿z l='S'

# â€¢Show best
# â€¢Show 2â€¿2 â¥Š {ğ•©++Ëœ1e308Ã—ğ•©=-z} q-z
# â€¢Show {
  
# } {âŸ¨0Â¨ğ•©,ğ•©,0Â¨ğ•©,0Â¨ğ•©âŸ©}l='E'

# â€¢Show (Â¬w)âŠ¸âˆ§Â¨ (â€¢ShowâŒ¾(2âŠ¸âŠ‘) q-z) = â€¢ShowâŒ¾(2âŠ¸âŠ‘) best+z-Ëœ{
#   (Â¬w)âŠ¸Ã—Â¨ ({âŒŠÂ´âŸ¨1âŠ¸âŒ½ğ•©,Â¯1âŠ¸âŒ½ğ•©âŸ©}ğ•©+1000) âŒŠ ğ•©âŒŠâŸ¨Â»,Â»Ë˜,Â«,Â«Ë˜âŸ©{ğ•ğ•©}Â¨ğ•©+1
# }_fx_â‰¢ âŠâŸœ0â€¿zÂ¨ {âŸ¨0Â¨ğ•©,ğ•©,0Â¨ğ•©,0Â¨ğ•©âŸ©}l='E'

â€¢Show +Â´â¥Š âˆ¨Â´{
  # âˆ¨Â´âŸ¨ğ•©, Â¯1âŒ½(Â¯1âŒ½q) = (ğ•©Ã—q)+1000, 1âŒ½(1âŒ½q) = (ğ•©Ã—q)+1000, (âŸ¨Â«,Â«Ë˜,Â»,Â»Ë˜âŸ©{ğ•ğ•©}Â¨ğ•©)Ã—q=Â¯1+âŸ¨Â«,Â«Ë˜,Â»,Â»Ë˜âŸ©{ğ•ğ•©}Â¨qâŸ©
  # â€¢Delay 0.2
  # â€¢Show ğ•©
  âˆ¨Â´âŸ¨ğ•©, (1âŒ½ğ•©) âˆ§ (Â¬w)âŠ¸âˆ§Â¨q=1âŒ½q-1000, (Â¯1âŒ½ğ•©) âˆ§ (Â¬w)âŠ¸âˆ§Â¨q=Â¯1âŒ½q-1000, (âŸ¨Â«,Â«Ë˜,Â»,Â»Ë˜âŸ©{ğ•ğ•©}Â¨ğ•©) âˆ§ (Â¬w)âŠ¸âˆ§Â¨ q=Â¯1+âŸ¨Â«,Â«Ë˜,Â»,Â»Ë˜âŸ©{ğ•ğ•©}Â¨qâŸ©
}_fx_â‰¢ (<l='E')âˆ§q=z+best
# â€¢Out "E"

