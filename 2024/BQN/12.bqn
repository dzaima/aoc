#!/usr/bin/env bqn
âŸ¨InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† >â€¢FLines 2024â€¿12 Input â€¢args

visited â† 0Â¨ l
p1 â† 0
p2 â† 0
shifts â† âŸ¨Â»Ë˜,Â«Ë˜,Â«,Â»âŸ©
{
  ğ•©âŠ‘visited? 1;
  lc â† ğ•©âŠ‘l
  c â† 1âŒ¾(ğ•©âŠ¸âŠ‘) 0Â¨l
  {
    ps â† (lc=âŠ‘âŸœl)Â¨âŠ¸/ (Â¬âŠ‘âŸœc)Â¨âŠ¸/ (âˆ§Â´â‰¥âŸœ0âˆ§<âŸœ(â‰ l))Â¨âŠ¸/ â· â¥Šğ•© +âŒœ âŸ¨Â¯1â€¿0,1â€¿0,0â€¿1,0â€¿Â¯1âŸ©
    c 1Â¨âŒ¾(psâŠ¸âŠ‘)â†©
    ps
  }â€¢_while_(Ã—â‰ ) â‹ˆğ•©
  area â† +Â´â¥Šc
  p1+â†© area Ã— +Â´ {+Â´â¥Š c âˆ§ Â¬ ğ• c}Â¨ shifts
  p2+â†© area Ã— +Â´ (2âŒ½shifts) {+Â´â¥Š (âŠ¢âˆ§Â·Â¬ğ•) c âˆ§ Â¬ ğ• c}Â¨ shifts
  visitedâˆ¨â†© c
}Â¨ â†•â‰¢l
â€¢Show p1
â€¢Show p2