#!/usr/bin/env bqn
âŸ¨RB, B10, Num, Repr, LCM, GCD, Ints, SInts, Split, SplitF, Indices, ReIndex, MDSlash, MDSlashI, Unjoin, Count, _fx_, _fi_, _underSelect_, Select, Tr, TW, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† >â€¢FLines 2024â€¿20 Input â€¢args
nwâ†lâ‰ '#'
e â† â‹ˆâ¼ MDSlash l='E'

S0 â† {âˆ¨Â´âŸ¨ğ•©,Â»ğ•©,Â«ğ•©,Â»Ë˜ğ•©,Â«Ë˜ğ•©âŸ©}
Step â† {nwâˆ§S0 ğ•©}
zero â† 0Â¨l
f0 â† (StepâŒ¾(1âŠ¸âŠ‘) 1âŠ¸+âŒ¾âŠ‘) _fi_(Â¬eâŠ‘1âŠ‘âŠ¢) 0â‹ˆl='S'
path â† (MDSlash l='S')âˆ¾ {â‹ˆâ¼ MDSlash ğ•¨<ğ•©}Â´Â¨ <Ë˜ 2â†• (âŠ¢âˆ¾<âˆ˜Stepâˆ˜(Â¯1âŠ‘âŠ¢)) 1âŠ‘Â¨ f0
Solve â† { ğ•Š k:
  cs â† âˆ§â·âˆ¾{(â·Â·â¥Š+âŒœ)Â´ ğ•©â¥Š< âŒ½Â¨âŠ¸âˆ¾ â‹ˆâŸœ- 0â€¿1}Â¨ 1â†“â†•k
  # â€¢Show cs
  # 
  z â† Â¯1+(â‰ path)- â¥Š{(ğ•©â‰ â‰ path) /â—‹â¥Š (+Â´Â¨|cs) +â‰1 (â†•â‰ path) + ğ•©} (âŒ½path) âŠ path +âŒœ cs
  # â€¢Show âˆ§Â´âˆ˜Ã—Ë˜âŠ¸/ â‰â†•âˆ˜â‰ âŠ¸â‰ /â¼ 0âŒˆ z
  # â€¢Show +Â´â‰¥âŸœ50 z
  +Â´â‰¥âŸœ100 z
}
â€¢Show Solve 3
â€¢Show Solve 21

# very slow part 1 that got me the answer before I managed to write the above:
# {
#   f0 â† (StepâŒ¾(1âŠ¸âŠ‘) 1âŠ¸+âŒ¾âŠ‘) _fi_(Â¬eâŠ‘1âŠ‘âŠ¢) 0â‹ˆl='S'
#   z â† (âŠ‘Â¯1âŠ‘f0) - âˆ¾{âŸ¨aâ€¿b,câ€¿dâŸ©: âˆ¾{{aâ€¿b: (eâŠ‘Step b)â¥Ša} (StepâŒ¾(1âŠ¸âŠ‘) 1âŠ¸+âŒ¾âŠ‘) _fx_({(Â¬âˆ¨Â´â¥Šğ•©)âˆ¨Â¬eâŠ‘ğ•©}1âŠ‘âŠ¢) 1âŠ¸+âŒ¾âŠ‘ {1âŒ¾(ğ•©âŠ¸âŠ‘)zero}âŒ¾(1âŠ¸âŠ‘) ğ•©}Â¨ {aâ€¿b: aâ‹ˆÂ¨MDSlash b} S0âŒ¾(1âŠ¸âŠ‘) âŸ¨c,dâˆ§Â¬bâŸ©}Â¨ <Ë˜ 2â†•f0
#   â€¢Show â‰â†•âˆ˜â‰ âŠ¸â‰ /â¼ 0âŒˆz
#   â€¢Show +Â´zâ‰¥100
# }
