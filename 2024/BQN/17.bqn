#!/usr/bin/env bqn
âŸ¨Ints, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† IntsÂ¨ â€¢FLines 2024â€¿17 Input â€¢args

# off â† 2â‹†52
# Xor â† {off-Ëœ âŠ‘{(8â€¢bit._xorË 6â†‘Ë˜ğ•©)âˆ¾6â†“âŠğ•©}âŒ¾(64â€¿8â€¢bit._castâŠ¢) â‰Ë˜ğ•¨â€¿ğ•©+off}
Xor â† 32â€¢bit._xorâŒ¾â‹ˆ

p â† 4âŠ‘l
Run â† {ğ•Šr:
  outsâ†âŸ¨âŸ©
  {
    ocâ€¿opâ†2â†‘ğ•©â†“p
    combo â† {ğ•©â‰¤3? ğ•©; 7: '!'; (ğ•©-4)âŠ‘r} op
    # â€¢Show ocâ€¿opâ‹ˆr
    ocâ—¶âŸ¨
      {r(âŒŠ(âŠ‘r)Ã·2â‹†combo)âŒ¾(  âŠ‘)â†© â‹„ ğ•©} # adv
      {r (op Xor âŠ¢)âŒ¾(1âŠ¸âŠ‘)â†© â‹„ ğ•©}     # bxl
      {r (8|combo)âŒ¾(1âŠ¸âŠ‘)â†© â‹„ ğ•©}      # bst
      {0=âŠ‘r?ğ•©; op}                  # jnz
      {r ((2âŠ‘r) Xor âŠ¢)âŒ¾(1âŠ¸âŠ‘)â†© â‹„ ğ•©}  # bxc
      {outsâˆ¾â†©8|comboâ‹„ğ•©}             # out
      {r(âŒŠ(âŠ‘r)Ã·2â‹†combo)âŒ¾(1âŠ¸âŠ‘)â†© â‹„ ğ•©} # bdv
      {r(âŒŠ(âŠ‘r)Ã·2â‹†combo)âŒ¾(2âŠ¸âŠ‘)â†© â‹„ ğ•©} # cdv
    âŸ© ğ•©+2
  }â€¢_while_{ğ•Š: ğ•©â‰ â‰ p} 0
  outs
}

â€¢Out 1â†“âˆ¾','âˆ¾Â¨â€¢ReprÂ¨ Run âŠ‘Â¨ 3â†‘l
# â€¢Show 1âŠ¸+â€¢_while_{ğ•Š: pâ‰¢Run ğ•©â€¿0â€¿0} 0 # the insufficient part 2 solution
