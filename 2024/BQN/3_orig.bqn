#!/usr/bin/env bqn
âŸ¨RB, B10, Num, Repr, LCM, GCD, Ints, SInts, Split, SplitF, ReIndex, MDSlash, MDSlashI, Unjoin, Count, _fx_, _fi_, Tr, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† â€¢FLines 2024â€¿3 Input â€¢args

on â† 1
# separation into block for reuse across parts added after solve; live I modified it in-place
Process â† {part2 ğ•Š l:
  S â† {âˆ¨âŸœÂ»âŸ(ğ•¨-1) (0â¥ŠËœğ•¨-1)âˆ¾Ëœğ•©}
  Next â† {
    lâ‰¡âŸ¨âŸ©? 0â€¿@;
    m â† âˆ§`ğ• l
    âŠ‘m?
      n â† +Â´m
      (lâ†“Ëœâ†©n) âŠ¢ 1â‹ˆnâ†‘l
    ;
      0â‹ˆ@
  }
  r â† â†•0
  any â† 0
  { ğ•Š:
    {ğ•Š:
      {ğ•Š: onâ†©1â‹„1}âŸâŠ¢ âŠ‘Next {{4 S "do()"â·ğ•©}}? 1;
      {ğ•Š: onâ†©0â‹„1}âŸâŠ¢ âŠ‘Next {{7 S "don't()"â·ğ•©}}? 1;
      0
    } â€¢_while_âŠ¢ part2
    anyâ†©âŠ‘Next {{4 S "mul("â·ğ•©}}?
    âŠ‘Â·â€¿aâ†Next {{ğ•©âˆŠ'0'+â†•10}}?
    âŠ‘    Next {{<`ğ•©=','}}?
    âŠ‘Â·â€¿bâ†Next {{ğ•©âˆŠ'0'+â†•10}}?
    âŠ‘    Next {{<`ğ•©=')'}}?
    # â€¢Show onâ€¿aâ€¿bâˆ¾â‰ l
    râˆ¾âŸonËœâ†© a Ã—â—‹â€¢ParseFloat b;
    l â†“Ëœâ†©Â¬any # originally this was `lâ†“Ëœâ†©1`, which was buggy
    @
  } â€¢_while_ {ğ•Š:Ã—â‰ l}@
  +Â´r
}
â€¢Show +Â´ 0 ProcessÂ¨ l
â€¢Show +Â´ 1 ProcessÂ¨ l
