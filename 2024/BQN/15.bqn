#!/usr/bin/env bqn
âŸ¨SplitF, _underSelect_, MDSlash, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
aâ€¿b â† âŸ¨âŸ©SplitF â€¢FLines 2024â€¿15 Input â€¢args
a >â†©
b âˆ¾â†©
{
  câ†a
  {
    d â† âŠ‘ð•©âŠËœ">v<^"
    c âŒ½âˆ˜â‰âŸdâ†©
    yâ€¿xâ† â‹ˆâ¼MDSlash c='@'
    c {ð•©â†“Ëœâ†©1â‹„('.'âŠËœð•©)<â—‹âŠ‘'#'âŠËœð•©? ".@"âˆ¾('O'â¥ŠËœk)âˆ¾(1+kâ†âŠ‘ð•©âŠ'.')â†“ð•©; ð•©}_underSelect_âŸ¨y, {x+â†•ð•©-x}1âŠ‘â‰¢câŸ©â†© # âŒ¾(xâ†“yâŠâŠ¢)â†©
    c âŒ½âˆ˜â‰âŸ(4|4-d)â†©
    1
  }Â¨ b
  â€¢Show +Â´âˆ¾100â€¿1âŠ¸Ã—Â¨ MDSlash c='O'
}

{
  c2 â† 2/Ë˜'.'Â¨âŒ¾((a='O')âŠ¸(/â—‹â¥Š)) a
  c2 '.'âŒ¾((1âŠ‘MDSlash c2='@')âŠ¸âŠ‘)â†©
  {c2 "[]"âŒ¾(((âŠ¢â‹ˆ0â€¿1âŠ¸+) ð•©Ã—1â€¿2)âŠ¸âŠ‘)â†©â‹„1}Â¨ MDSlash a='O'
  {
    d â† âŠ‘ð•©âŠËœ">v<^"
    {
      âŠ‘dâˆŠ0â€¿2?
        c2 âŒ½âˆ˜â‰âŸdâ†©
        yâ€¿xâ† â‹ˆâ¼MDSlash c2='@'
        c2 {ð•©â†“Ëœâ†©1â‹„('.'âŠËœð•©)<â—‹âŠ‘'#'âŠËœð•©? ".@"âˆ¾(kâ†‘ð•©)âˆ¾(1+kâ†âŠ‘ð•©âŠ'.')â†“ð•©; ð•©}_underSelect_âŸ¨y, {x+â†•ð•©-x}1âŠ‘â‰¢c2âŸ©â†© #âŒ¾âŒ½âŒ¾((1+x)â†‘yâŠâŠ¢)â†©
        c2 âŒ½âˆ˜â‰âŸ(4-d)â†©
      ;
        c2 âŒ½âŸ(d=1)â†©
        ma â† c2='@'
        {ð•Š:
          tâ†Â«ð•©
          t2â†tâˆ§c2â‰ '.'
          t2âˆ¨â†© Â»Ë˜ t2 âˆ§ c2='['
          t2âˆ¨â†© Â«Ë˜ t2 âˆ§ c2=']'
          maâˆ¨â†©t2
          t2
        }â€¢_while_(âˆ¨Â´â¥Š) ma
        {ð•Š: v0â†ma/â—‹â¥Šc2â‹„ c2 '.'Â¨âŒ¾((/â¥Šma)âŠâ¥Š)â†© â‹„ c2 v0âŒ¾((/â¥ŠÂ«ma)âŠâ¥Š)â†©}âŸâŠ¢ âˆ§Â´'#'â‰ (Â«ma)/â—‹â¥Šc2
        c2 âŒ½âŸ(d=1)â†©
    }
    1
  }Â¨ b
  â€¢Show +Â´âˆ¾100â€¿1âŠ¸Ã—Â¨ MDSlash c2='['
}