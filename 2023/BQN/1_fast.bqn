#!/usr/bin/env cbqn
l â† â€¢file.MapBytes â‰ â—¶"1.in"â€¿âŠ‘ â€¢args
! (@+10) = Â¯1âŠ‘l

_chunkByTo_ â† { F _ğ•£_ charâ€¿tgt raw:
  {minâ€¿max: F minâ†“maxâ†‘raw}Â¨ <Ë˜ 2â†•â· (â‰ raw)âˆ¾Ëœ 0âˆ¾ {
    ğ•© + 1+âŠ‘ (ğ•©â†“raw) âŠ char # fast due to slices & short-circuit
  }Â¨ tgtÃ—â†•âŒˆ(â‰ ğ•©)Ã·tgt
}

names â† "one"â€¿"two"â€¿"three"â€¿"four"â€¿"five"â€¿"six"â€¿"seven"â€¿"eight"â€¿"nine"
unq â† â·âˆ¾names

unqNth â† ' 'âŠ¸â‰ âŠ¸/Â¨ â·Â¨ <Ë˜â‰>5â†‘Â¨names
reqShifts â† âˆ¾â‹ˆÂ¨Â¨âŸœâ†•âŸœâ‰  unqNth
doShifts â† {ğ•©=0? (âŠ‘unqâŠğ•¨)âŠ‘âŠ¢; (ğ•©â¥Š0)Â«(âŠ‘unqâŠğ•¨)âŠ‘âŠ¢}Â´Â¨ reqShifts
doAnds â† {âˆ§Â´(reqShiftsâŠâ‹ˆÂ¨âŸœâ†•âŸœâ‰  ğ•©)âŠâŠ¢}Â¨ names

mults â† ('1'+â†•9) - âŠ‘Â¨names

part1 â† 0
part2 â† 0

FirstLast â† {
  nls â† ğ•©=@+10
  d0 â† '0' -Ëœ (1Â»nls) / ğ•©
  d1 â† '0' -Ëœ (1Â«Â¯1â†“nls) / Â¯1â†“ğ•©
  +Â´d1 + 10Ã—d0
}
Filter â† âˆŠâŸœ((@+10)âˆ¾'1'+â†•9)âŠ¸/

{
  part1+â†© FirstLast Filter ğ•©
  uv â† ğ•©âŠ¸=Â¨ unq
  shifts â† {ğ• uv}Â¨ doShifts
  ands â† {ğ• shifts}Â¨ doAnds
  ğ•© â†© ğ•© + +Â´ mults Ã— ands
  ğ•© â†© Filter ğ•©
  part2+â†© FirstLast ğ•©
  @
} _chunkByTo_ âŸ¨@+10, 15000âŸ© l

â€¢Show part1
â€¢Show part2