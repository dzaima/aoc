#!/usr/bin/env bqn
âŸ¨_fx_, MDSlash, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
m â† >â€¢FLines 2023â€¿10 Input â€¢args

l â† mâˆŠ"-J7S"
r â† mâˆŠ"-FLS"
u â† mâˆŠ"|LJS"
d â† mâˆŠ"|F7S"

lâˆ§â†© Â»Ë˜r
râˆ§â†© Â«Ë˜l
uâˆ§â†© Â» d
dâˆ§â†© Â« u

ludr â† lâ€¿uâ€¿dâ€¿r
delta â† âŸ¨0â€¿Â¯1, Â¯1â€¿0, 1â€¿0, 0â€¿1âŸ©
masks â† âŒ½â‰ âŸœ< â†•4

dist â† âŠ‘ {mâ€¿iâ€¿p:
  ppâ†4â†“Â¨p
  âŸ¨
    {iÂ¨âŒ¾((0=ğ•©)âŠ¸/)ğ•©}âŒ¾(ppâŠ¸âŠ‘)m,
    i+1,
    âˆ¾pp {(ğ•©/masks) (âŠ£âˆ¾ğ•¨+âŠ¢)Â¨ ğ•©/delta}Â¨ (4â†‘Â¨p) âˆ§ <Ë˜ppâŠ‘âŒœludr
  âŸ©
}_fx_(â‰¢â—‹âŠ‘) âŸ¨0Â¨ m, 1, 1â€¿1â€¿1â€¿1âŠ¸âˆ¾Â¨ MDSlash m='S'âŸ©

â€¢Show Â¯1 + âŒˆÂ´â¥Šdist

mw â† distâ‰ 0 # mini walls
xw â† {mwâ€¿lâ€¿râ€¿uâ€¿d: mw âˆ¨Â´ âŸ¨Â»d,Â«u,Â»Ë˜r,Â«Ë˜lâŸ©} {(âˆ§âŒœÂ´ â¥ŠâŸœ0â€¿1â€¿0Â¨ 3Ã—â‰¢ğ•©) âˆ§ âŸ¨<3,<3âŸ© / mwÃ—ğ•©}Â¨ mwâ€¿lâ€¿râ€¿uâ€¿d # expanded walls

f â† {ğ•© âˆ¨Â´ (Â¬xw)âŠ¸Ã—Â¨ âŸ¨Â»ğ•©,Â«ğ•©,Â»Ë˜ğ•©,Â«Ë˜ğ•©âŸ©}_fx_â‰¢ xw < 1(Â»Ë˜âˆ¨Â«Ë˜) 1Â¨âˆ˜âŠâŠ¸(Â»âˆ¨Â«) 0Â¨ xw # flood fill into expanded space
â€¢Show +Â´â¥ŠÂ¬ mw âˆ¨ (â¥ŠâŸœ0â€¿1â€¿0Â¨ â‰¢f) / f