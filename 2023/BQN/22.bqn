#!/usr/bin/env bqn
âŸ¨Split,_fx_âŸ© â† â€¢Import "../../utils/utils.bqn"
l â† {0â€¿1 + {â€¢ParseFloatÂ¨ ',' Split ğ•©}Â¨ '~' Split ğ•©}Â¨ â€¢FLines â‰ â—¶"22.in"â€¿âŠ‘ â€¢args

{ğ•©!âˆ§Â´<Â´ğ•©}Â¨ l

x0â€¿y0â€¿z0â€¿x1â€¿y1â€¿z1 â† <Ë˜â‰> âˆ¾Â¨ l

di â† {/((2âŠ‘0âŠ‘ğ•©)â‰¥z1) âˆ§ ((0â€¿1âŠ1âŠ‘ğ•©)>x0â€¿y0)âˆ§â—‹(âˆ§Â´)(0â€¿1âŠ0âŠ‘ğ•©)<x1â€¿y1}Â¨ l # which bricks the n'th bridge can depend on
dh â† âŠâŸœ(z1-z0)Â¨ di # the height of the specific dependency

Min â† {diâ€¿dh ğ•Š zC: zC âŒŠ dh {1âŒˆÂ´ ğ•¨ + ğ•©âŠzC}Â¨ di}            #             decrease heights to those demanded by dependencies
z2  â† {      ğ•Š zC: zC âŒˆ dh {1âŒˆÂ´ ğ•¨ + ğ•©âŠzC}Â¨ di} _fx_â‰¢ 1Â¨ l # iteratively increase heights to those demanded by dependencies
â€¢Show (â‰ l) - +Â´âˆŠ âˆ¾ (â†•â‰ z2) {(1=â‰ )âŠ¸/ ((ğ•¨âŠ‘z2) = (ğ•¨âŠ‘dh) + ğ•©âŠz2)/ğ•©}Â¨ di # for each brick, filter its dependencies to those that are directly below it, and report if there's only one such


â€¢Show +Â´ {+Â´ z2 â‰  ((diâ‰ ğ•©)âŠ¸(/Â¨)Â¨ diâ€¿dh)âŠ¸Min _fx_â‰¢ z2}Â¨ â†•â‰ l # remove each brick, see whose z changes