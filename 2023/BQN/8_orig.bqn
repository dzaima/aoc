#!/usr/bin/env bqn
âŸ¨RB, B10, Num, Ints, Split, SplitF, ReIndex, MDSlash, Unjoin, Count, GCD, LCM, _fx_, _fi_, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† â€¢FLines 2023â€¿8 Input â€¢args
s â† 'L'=âŠ‘l

kâ€¿lvâ€¿rv â† <Ë˜â‰> {âŸ¨3â†‘ğ•©, 3â†‘7â†“ğ•©, 3â†‘12â†“ğ•©âŸ©}Â¨ 2â†“l
tl â† k â€¢HashMap lv
tr â† k â€¢HashMap rv



Step â† {ğ•Š:
  (ğ•¨+1) â‹ˆ ((((â‰ s)|ğ•¨)âŠ‘s)âŠ‘trâ€¿tl).Get ğ•©
}Â´
F â† {
  Stepâ€¢_while_ {'Z'â‰¢2âŠ‘1âŠ‘ğ•©} ğ•©
}

â€¢Show âŠ‘ F 0â‹ˆ"AAA"

â€¢Show LCMÂ´ âŠ‘Â¨ FÂ¨ 0â‹ˆÂ¨ ('A'=2âŠ‘Â¨k)/k # I don't think this quite makes sense but annoyingly it gives the right value so