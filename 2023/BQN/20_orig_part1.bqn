#!/usr/bin/env bqn
âŸ¨Split, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† {{âŸ¨âŠ‘ğ•©âŸ©âˆ¾Â¯1â†“Â¨2â†“ğ•©} ' ' Split ğ•©âˆ¾","}Â¨ â€¢FLines 2023â€¿20 Input â€¢args
lâˆ¾â†©< âŸ¨"%rx"âŸ©
knâ† âŠ‘Â¨l
vnâ† 1â†“Â¨l
v â† (1â†“Â¨kn)âŠ¸âŠÂ¨ vn
t â† âŠ‘Â¨kn
k â† â†•â‰ kn
conn â† â‰ Â¨ ((âˆ¾v)âˆ¾â‰ k)âŠ”(â‰ Â¨v)/â†•â‰ v # conn number
om â† =âŸœ<â†•â‰ k # one mask
zm â† Â¬om # zero mask

rx â† Â¯1+â‰ k

# â€¢Show (Â¬(âˆ¾v) âˆŠ k)/âˆ¾vn

! âˆ§Â´ (âˆ¾v) âˆŠ k

# â€¢ShowÂ¨ tâˆ¾Â¨kâˆ¾Â¨v
br â† âŠ‘knâŠ<"broadcaster"
mem0 â† (0Â¨ t){ğ•©â‰¡'&'? ğ•—; 0}Â¨ t

ls â† 0
hs â† 0
Step â† {mğ•Šwâ€¿iâ€¿h:
  ! âˆ§Â´(rx=i)/h
  ls+â†© +Â´Â¬h
  hs+â†© +Â´h
  # â€¢Out ""
  # â€¢Show m
  # â€¢Show wâ€¿iâ€¿h
  fâ†'%'=iâŠt
  # â€¢Out"--"
  # â€¢Show â‰¡h
  # â€¢Show h
  # â€¢Show i
  ffâ†i/Ëœfâˆ§Â¬h
  mÂ¬âŒ¾(ffâŠ¸âŠ)â†©
  ffr â† {âŸ¨ff/Ëœâ‰ Â¨ğ•©,âˆ¾ğ•©,(â‰ Â¨ğ•©)/ffâŠmâŸ©} ffâŠv
  # â€¢Show 1+ff
  ! 1â‰¥â‰¡2âŠ‘ffr
  a â† Â¬f
  ah â† aâˆ§h
  al â† aâˆ§Â¬h
  ! 1=â‰¡(t='%')/m
  m â†© mâˆ¨{âˆ¨Â´ğ•©âŠom}Â¨ ((ah/i)âˆ¾â‰ m) âŠ” ah/w
  ! 1=â‰¡(t='%')/m
  m â†© mâˆ§{âˆ§Â´ğ•©âŠzm}Â¨ ((al/i)âˆ¾â‰ m) âŠ” al/w
  #â€¢Show ah
  #â€¢Show al
  #â€¢Show a/w
  ! 1=â‰¡(t='%')/m
  anr â† (âŠâŸœv)âŠ¸{lâ†â‰ Â¨ğ•¨â‹„âŸ¨l/ğ•©, âˆ¾ğ•¨, l/(ğ•©âŠconn) â‰  +Â´Â¨ğ•©âŠmâŸ©} a/i
  ! 1â‰¥â‰¡2âŠ‘anr
  # â€¢Show v
  # â€¢Out ""
  âŸ¨m, ffrâˆ¾Â¨anrâŸ©
}

bp0 â† {âŸ¨brÂ¨ğ•©,ğ•©,0Â¨ğ•©âŸ©} brâŠ‘v
Press â† {ls+â†©1 â‹„ âŠ‘ StepÂ´â€¢_while_{Ã—â‰ âŠ‘1âŠ‘ğ•©} ğ•©â€¿bp0}
PressâŸ1000 mem0
# â€¢Show ls
# â€¢Show hs
â€¢Show lsÃ—hs
