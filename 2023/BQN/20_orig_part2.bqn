#!/usr/bin/env bqn
âŸ¨SplitâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† {{âŸ¨âŠ‘ğ•©âŸ©âˆ¾Â¯1â†“Â¨2â†“ğ•©} ' ' Split ğ•©âˆ¾","}Â¨ â€¢FLines â‰ â—¶"20.in"â€¿âŠ‘ â€¢args
lâˆ¾â†©< âŸ¨"%rx"âŸ©
knâ† âŠ‘Â¨l
vnâ† 1â†“Â¨l
v â† (1â†“Â¨kn)âŠ¸âŠÂ¨ vn
t â† âŠ‘Â¨kn
k â† â†•â‰ kn
conn â† â‰ Â¨ ((âˆ¾v)âˆ¾â‰ k)âŠ”(â‰ Â¨v)/â†•â‰ v # conn number
om â† =âŸœ<â†•â‰ k # one mask
zm â† Â¬om # zero mask


# â€¢ShowÂ¨ âˆ¾(kn)(<âŠ¸(â‹ˆÂ¨))Â¨vn
# â€¢Exit 0

rx â† Â¯1+â‰ k

rx3 â† {/âˆ¨Â´Â¨ ğ•©âŠ¸âˆŠÂ¨v}âŸ2 â‹ˆrx

# â€¢Show (Â¬(âˆ¾v) âˆŠ k)/âˆ¾vn

! âˆ§Â´ (âˆ¾v) âˆŠ k


# â€¢ShowÂ¨ tâˆ¾Â¨kâˆ¾Â¨v
br â† âŠ‘knâŠ<"broadcaster"
mem0 â† (0Â¨ t){ğ•©â‰¡'&'? ğ•—; 0}Â¨ t

ls â† 0
hs â† 0
hist â† âŸ¨âŸ©Â¨ k
bpcâ†0
Step â† {ğ•Štickâ€¿mâ€¿wâ€¿iâ€¿h:
  # ! âˆ§Â´(rx=i)/h
  rxm â† hâˆ§wâˆŠrx3
  hist âˆ¾âŸœbpcÂ¨âŒ¾((rxm/w)âŠ¸âŠ)â†©
  # {histâˆ¾âŸœ(ğ•©âŠ‘h)âŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘)â†©â‹„1}Â¨ /rxm
  # {ğ•©âŠ‘h? histâˆ¾âŸœtickâŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘)â†©â‹„1;1}Â¨ /rxm
  # â€¢Show rxm/i
  ls+â†© +Â´Â¬h
  hs+â†© +Â´h
  # â€¢Out ""
  # â€¢Show m
  # â€¢Show wâ€¿iâ€¿h
  fâ†'%'=iâŠt
  # â€¢Out"--"
  # â€¢Show â‰¡h
  # â€¢Show h
  # â€¢Show i
  ffâ†i/Ëœfâˆ§Â¬h
  mÂ¬âŒ¾(ffâŠ¸âŠ)â†©
  ffr â† {âŸ¨ff/Ëœâ‰ Â¨ğ•©,âˆ¾ğ•©,(â‰ Â¨ğ•©)/ffâŠmâŸ©} ffâŠv
  # â€¢Show 1+ff
  # ! 1â‰¥â‰¡2âŠ‘ffr
  a â† Â¬f
  ah â† aâˆ§h
  al â† aâˆ§Â¬h
  # ! 1=â‰¡(t='%')/m
  # ! 1=â‰¡(t='%')/m
  # m â†© mâˆ¨{âˆ¨Â´ğ•©âŠom}Â¨ ((ah/i)âˆ¾â‰ m) âŠ” ah/w
  # m â†© mâˆ§{âˆ§Â´ğ•©âŠzm}Â¨ ((al/i)âˆ¾â‰ m) âŠ” al/w
  # {âŸ¨âŸ©ğ•Šğ•©:0; mâˆ¨âŸœ(âˆ¨Â´ğ•¨âŠom)âŒ¾(ğ•©âŠ¸âŠ‘)â†©â‹„0}Â¨âŸœâ†•âŸœâ‰  ((ah/i)âˆ¾â‰ m) âŠ” ah/w
  # {âŸ¨âŸ©ğ•Šğ•©:0; mâˆ§âŸœ(âˆ§Â´ğ•¨âŠzm)âŒ¾(ğ•©âŠ¸âŠ‘)â†©â‹„0}Â¨âŸœâ†•âŸœâ‰  ((al/i)âˆ¾â‰ m) âŠ” al/w
  {mâˆ¨âŸœ((ğ•©âŠ‘w)âŠ‘om)âŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘)â†©â‹„0}Â¨ /ah
  {mâˆ§âŸœ((ğ•©âŠ‘w)âŠ‘zm)âŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘)â†©â‹„0}Â¨ /al
  #â€¢Show ah
  #â€¢Show al
  #â€¢Show a/w
  ! 1=â‰¡(t='%')/m
  anr â† (âŠâŸœv)âŠ¸{lâ†â‰ Â¨ğ•¨â‹„âŸ¨l/ğ•©, âˆ¾ğ•¨, l/(ğ•©âŠconn) â‰  +Â´Â¨ğ•©âŠmâŸ©} a/i
  ! 1â‰¥â‰¡2âŠ‘anr
  # â€¢Show v
  # â€¢Out ""
  âŸ¨tick+1,mâŸ©âˆ¾ffrâˆ¾Â¨anr
}

bp0 â† {âŸ¨brÂ¨ğ•©,ğ•©,0Â¨ğ•©âŸ©} brâŠ‘v
Press â† {ls+â†©1 â‹„ 1âŠ‘ tâ†Step â€¢_while_{Ã—â‰ 2âŠ‘ğ•©} 0â€¿ğ•©âˆ¾bp0}
PressâŸ1000 mem0
â€¢Show lsÃ—hs
# â€¢Show ls
# â€¢Show hs


# hist â† âŸ¨0,â‰ rx3âŸ©â¥Š0
{
  bpc+â†©1
  m â† Press ğ•©
  # histâˆ¾â†© rx3âŠm
  m
}âŸ30000 mem0
# {â€¢Show -âŸœÂ» /{Â¬ğ•©âˆŠ1â€¿2} -âŸœÂ»/ğ•©}Â¨ rx3âŠhist
# â€¢ShowÂ¨ {qâ†-âŸœÂ» /{Â¬ğ•©âˆŠ1â€¿2} -âŸœÂ»/ğ•© â‹„ 1<â‰ q? q; 20â†‘1000â†“ğ•©}Â¨ rx3âŠhist
â€¢Show â€¢math.LCMÂ´ Â¯1âŠ‘Â¨ {-âŸœÂ»ğ•©}Â¨ Ã—âˆ˜â‰ Â¨âŠ¸/ hist
# vs â† {-âŸœÂ»/0â€¿1â·ğ•©}Â¨ <Ë˜ â‰hist
# â€¢ShowÂ¨ {âŠâŒ¾âŒ½ğ•©}Â¨ vs

# > 35891323 # 6289Ã—5707
# < 123813786835145216L