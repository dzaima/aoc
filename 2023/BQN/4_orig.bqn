#!/usr/bin/env cbqn
âŸ¨RB, B10, Num, Ints, Split, SplitF, ReIndex, MDSlash, Unjoin, Count, GCD, LCM, _fx_, _fi_, TâŸ© â† â€¢Import "utils.bqn"
l â† {â€¢ParseFloatÂ¨Â¨ ' 'SplitÂ¨ '|'Split 1âŠ‘':'Splitğ•©}Â¨â€¢FLines â‰ â—¶"4.in"â€¿âŠ‘ â€¢args

â€¢Show +Â´(0.5âŠ¸â‰ âŠ¸Ã—) 2â‹†Â¯1++Â´Â¨âˆŠËœÂ´Â¨l
csâ†1Â¨l
(â†•â‰ l) {
  p â† +Â´âˆŠËœÂ´ğ•©
  
  cs (ğ•¨âŠ‘cs)âŠ¸+âŒ¾(((p)âŒŠ(Â¯1+â‰ cs)-ğ•¨)â†‘(1+ğ•¨)â†“âŠ¢)â†©
}Â¨ l

â€¢Show +Â´cs