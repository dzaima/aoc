#!/usr/bin/env bqn
âŸ¨Split,_fx_,InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† ' 'SplitÂ¨â€¢FLines 2023â€¿18 Input â€¢args
d â† âŠ‘âˆ˜âŠ‘Â¨l
j â† (â€¢ParseFloat 1âŠ‘âŠ¢)Â¨ l

d â†© j/d
w â† {1Â¨âŒ¾((<Ë˜ğ•©)âŠ¸âŠ‘) 0â¥ŠËœ1+âŒˆËğ•©} c â† {ğ•©-â‰1âŒŠËğ•©} +`("URDL"âŠd)âŠ[Â¯1â€¿0, 0â€¿1, 1â€¿0, 0â€¿Â¯1]

pos â† (Â¯1+(âŠ‘/"DL"â·d)âŠc) # added after finishing to become general; I just tried random positions until it worked

m â† wâˆ¨{(Â¬w)âˆ§âˆ¨Â´âŸ¨ğ•©,Â»ğ•©,Â«ğ•©,Â»Ë˜ğ•©,Â«Ë˜ğ•©âŸ©}_fx_â‰¢ 1âŒ¾(posâŠ¸âŠ‘) 0Â¨w
# â€¢Show âŠâŸœ"Â·#" m
â€¢Show +Â´â¥Šm

qâ†0
xâ€¿y â† <Ë˜â‰>+`{
  a â† Â¯1â†“2â†“ğ•©
  d â† ('0'-ËœÂ¯1âŠ‘a)âŠ[0â€¿1, 1â€¿0, 0â€¿Â¯1, Â¯1â€¿0]
  lâ†+Â´(âŒ½16â‹†â†•5)Ã—{ğ•©+(ğ•©â‰¥10)Ã—10+'0'-'a'} (Â¯1â†“a)-'0'
  q+â†©|l
  d Ã— l
}Â¨ 2âŠ‘Â¨l

â€¢Show 1+2Ã·Ëœq+|+Â´(xÃ—Â¯1âŒ½y)-yÃ—Â¯1âŒ½x