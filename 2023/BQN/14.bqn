#!/usr/bin/env bqn
âŸ¨_fx_âŸ© â† â€¢Import "../../utils/utils.bqn"
l â† ".#O" âŠ >â€¢FLines â‰ â—¶"14.in"â€¿âŠ‘ â€¢args


inds â† â¥Š (â‰ l) / â‰â†•1+â‰ l
main â† â¥Š (1Â¨l) âˆ¾Ë˜ 0Â¨âŠl
zero â† â¥Š 0â¥ŠËœ1â€¿0+â‰¢l
Move â† { # filter a whole-array scan
  wmâ€¿t1jâ€¿tj1â€¿tj1sğ•Šğ•©:
  cs â† tj1 / â¥Šâ‰ (âŠ¢âˆ¾Â¯1âŠâŠ¢) +`2=ğ•©
  ls â† cs - Â»cs Ã— tj1 / main
  xs â† / tj1s
  ys â† ls + t1j / inds
  wm -Ëœ 2Ã—Â¬ â‰ ` wm â‰  (â‰¢ğ•©) â¥Š 1Â¨âŒ¾((xs+ysÃ—â‰ ğ•©)âŠâŠ¢) zero
}
pre0â€¿pre1â€¿pre2â€¿pre3 â† {
  row1 â† 1Â¨âŠl
  wm â† 1=ğ• l
  t1j â† â¥Šâ‰ row1 âˆ¾ wm
  tj1m â† â‰ wm âˆ¾ row1
  tj1 â† â¥Š tj1m
  tj1s â† +ËË˜tj1m
  wmâ€¿t1jâ€¿tj1â€¿tj1s
}Â¨ âŸ¨âŠ¢, â‰, âŒ½, âŒ½â‰âŸ©

# lâŠâ†©1â€¿0â€¿2 â‹„ Move â†© {ğ•© + Â«âŠ¸- (1=Â»ğ•©)âˆ§2=ğ•©}_fx_â‰¢âˆ˜âŠ¢ # simple iterative moving

Load â† {+Â´ (+ËË˜ Ã— 1+âŒ½âˆ˜â†•âˆ˜â‰ ) 2=ğ•©}

â€¢Show Load pre0 Move l

p â† âŸ¨âŸ©
v â† l

m â† â€¢HashMapËœ âŸ¨âŸ©
{ ğ•Š:
  pâˆ¾â†© <v
  v â†© pre3âŠ¸MoveâŒ¾(âŒ½â‰) pre2âŠ¸MoveâŒ¾âŒ½ pre1âŠ¸MoveâŒ¾â‰ pre0âŠ¸Move v
  {m.Has v? 0; 1âŠ£ v m.Set â‰ p}
}â€¢_while_âŠ¢ 1

a â† m.Get v
b â† â‰ p

â€¢Show Load pâŠ‘Ëœ a+(b-a)|1000000000-a