#!/usr/bin/env bqn
âŸ¨Split, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† {{âŸ¨âŠ‘ğ•©âŸ©âˆ¾Â¯1â†“Â¨2â†“ğ•©} ' ' Split ğ•©âˆ¾","}Â¨ â€¢FLines 2023â€¿20 Input â€¢args
lâˆ¾â†©< âŸ¨"%rx"âŸ©
knâ† âŠ‘Â¨l
vnâ† 1â†“Â¨l
v â† (1â†“Â¨kn)âŠ¸âŠÂ¨ vn
t â† âŠ‘Â¨kn
k â† â†•â‰ kn
cc â† â‰ Â¨ ((âˆ¾v)âˆ¾â‰ k) âŠ” (â‰ Â¨v)/â†•â‰ v # connection count
! âˆ§Â´ (âˆ¾v) âˆŠ k


rx â† Â¯1+â‰ k
rx2 â† {/âˆ¨Â´Â¨ ğ•©âŠ¸âˆŠÂ¨v}âŸ2 â‹ˆrx


om â† =âŸœ<â†•â‰ k # one mask
zm â† Â¬om # zero mask
ls â† 0
hs â† 0
first â† âˆÂ¨ k
bpc â† 0
Step â† {ğ•Šmâ€¿wâ€¿iâ€¿h:
  
  rxm â† hâˆ§wâˆŠrx2
  first bpcÂ¨âŠ¸âŒŠâŒ¾((rxm/w)âŠ¸âŠ) â†©
  
  ls+â†© +Â´Â¬h
  hs+â†© +Â´h
  
  f â† '%'=iâŠt
  a â† Â¬f
  
  ff â† i/Ëœfâˆ§Â¬h
  m Â¬âŒ¾(ffâŠ¸âŠ) â†©
  ffr â† {lâ†â‰ Â¨ğ•© â‹„ âŸ¨l/ff, âˆ¾ğ•©, l/ffâŠmâŸ©} ffâŠv
  
  ah â† aâˆ§h
  al â† aâˆ§Â¬h
  {m ((ğ•©âŠ‘w)âŠ‘om)âŠ¸âˆ¨âŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘) â†© â‹„ 0}Â¨ /ah
  {m ((ğ•©âŠ‘w)âŠ‘zm)âŠ¸âˆ§âŒ¾((ğ•©âŠ‘i)âŠ¸âŠ‘) â†© â‹„ 0}Â¨ /al
  anr â† (âŠâŸœv)âŠ¸{lâ†â‰ Â¨ğ•¨â‹„âŸ¨l/ğ•©, âˆ¾ğ•¨, l/(ğ•©âŠcc) â‰  +Â´Â¨ğ•©âŠmâŸ©} a/i
  
  âŸ¨mâŸ©âˆ¾ffrâˆ¾Â¨anr
}

br â† âŠ‘knâŠ<"broadcaster"
bp0 â† {âŸ¨brÂ¨ğ•©,ğ•©,0Â¨ğ•©âŸ©} brâŠ‘v
Press â† {ls+â†©1 â‹„ âŠ‘Step â€¢_while_{Ã—â‰ 1âŠ‘ğ•©} âŸ¨ğ•©âŸ©âˆ¾bp0}

mem0 â† (0Â¨ t){ğ•©â‰¡'&'? ğ•—; 0}Â¨ t
{
  bpc+â†© 1
  r â† Press ğ•©
  â€¢ShowâŸ(bpcâ‰¡1000) lsÃ—hs
  r
}â€¢_while_{ğ•Š: (bpc<1000) âˆ¨ (â‰ rx2) â‰  +Â´ âˆâ‰ first} mem0

â€¢Show â€¢math.LCMÂ´ âˆâŠ¸â‰ âŠ¸/ first
