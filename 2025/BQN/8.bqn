#!/usr/bin/env bqn
âŸ¨Ints, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† IntsÂ¨ â€¢FLines 2025â€¿8 Input â€¢args
n â† â‰ l

t â† <Ë˜â‰> l # transposed form (âŸ¨all xs, all ys, all zsâŸ©) for more array-y processing
pi â† â‹ âˆ¾ (â†•n) {+Â´Ã—Ëœğ•©-ğ•¨â†‘Â¨t}Â¨ l # get distance between all combinations of pairs (without duplicates)
tri â† +` â†•n # as the above is indices in a deshaped triangle, compute the start index of each triangle row
j0 â† tri â‹ pi # get row for each index (i.e. one junction of the connection)
j1 â† pi - j0âŠÂ»tri # and the respective columns (i.e. other junction)

c â† â†•n # "map" of junction â†’ circuit ID, shared between both parts

p1n â† {n=20? 10; 1000}
p1j â† p1nâ†‘Â¨j0â€¿j1 # the asked-for connections
{
  aâ€¿b â† ğ•¨â€¿ğ•©âŠc # circuit IDs of the boxes
  aâ‰ b?        # if they're not equal,
    c aÂ¨âŒ¾((b=c)âŠ¸/)â†© â‹„ @; # change ones ID to the others
  @
}Â¨Â´ p1j

â€¢Show Ã—Â´ 3â†‘ âˆ¨ /â¼c

# part 2; continues using the same circuit map started before
{ğ•Š: # while not done:
  j â† ğ•©âŠ‘Â¨j0â€¿j1 # next pair of junctions
  aâ€¿b â† jâŠc    # the circuit IDs of those
  aâ‰ b?
    c aÂ¨âŒ¾((b=c)âŠ¸/)â†© # merge them if needed
    {ğ•Š:
      â€¢Show Ã—Â´ j âŠ âŠ‘t # print the part 2 result
      @               # and stop the loop,
    }âŸ(âˆ§Â´c=âŠ‘c) ğ•©+1 # if all circuit IDs are the same
  ;ğ•©+1
}â€¢_while_(@âŠ¸â‰¢) p1n
