#!/usr/bin/env bqn
# part 1: 19:51; both: 46:21
âŸ¨RB, B10, Num, Repr, LCM, GCD, Ints, SInts, Split, SplitF, Indices, ReIndex, MDSlash, MDSlashI, Unjoin, Count, _fx_, _fi_, _underSelect_, Select, Tr, TW, _memo, InputâŸ© â† â€¢Import "../../utils/utils.bqn"
l â† IntsÂ¨ â€¢FLines 2025â€¿9 Input â€¢args
â€¢Show âŒˆÂ´(<Ë˜â‰>l) {âŒˆÂ´Ã—Â´|1+ğ•—-ğ•©}Â¨ l

# miserable garbage from having somehow misread the problem as disallowing red tiles within the rectangle
# {ğ•Šl:
#   yâ€¿x â† <Ë˜â‰>âˆ§l
#   cy â† âŠy
#   yx â† cyâŠ”x
#   m â† 0
#   {ğ•Š y0â€¿x0:
#     cy0 â† Â¯1+âŠ‘yâ‹y0
#     w â† âˆ
#     (cy0â†“cy){ cy1ğ•Šcy:
#       # â€¢Show ğ•¨â€¿ğ•©
#       h â† 1+cy-y0
#       f â† â‰¥âŸœx0âŠ¸/ cy1âŠ‘ yx
#       Ã—â‰ f?
#       w0 â† (âŒˆÂ´ f)-x0
#       mâŒˆâ†© hÃ—w0
#       wâŒŠâ†© w0
#       1;1
#     }Â¨cy0â†“y
#   }Â¨ l
#   â€¢Show "D"â‹ˆm
# }Â¨ âŸ¨l, -âŒ¾(âŠ‘Â¨) lâŸ©

# â€¢Show {âŠâŸœ"Â·#"1Â¨âŒ¾(ğ•©âŠ¸âŠ‘) 0â¥ŠËœ1+âŒˆÂ´ğ•©}âˆ˜(<Ë˜Â·â‰>) âŠÂ¨<Ë˜â‰>l
{
  t â† <Ë˜â‰>l
  ul â† âˆ§âˆ˜â·Â¨t
  # up â†{âŠâŒ¾((â‹ğ•©)âŠ¸âŠ)ğ•©}Â¨t
  up â† ulâŠÂ¨t
  m â† {
    p â† ğ•©
    p â†© âˆ¾ğ•© {(<ğ•¨âŒŠğ•©)+â¥Šâ†•1+|ğ•¨-ğ•©}Â¨ 1âŒ½ğ•©
    1Â¨âŒ¾(pâŠ¸âŠ‘) 0â¥ŠËœ1+âŒˆÂ´ğ•©
  } <Ë˜â‰> up
  
  f â† 1âŒ¾((âŒŠ0.5â€¿0.25Ã—â‰ Â¨ul)âŠ¸âŠ‘) 0Â¨m
  âŠ¢â€¢_while_{ğ•Š:
    n â† (Â¬m)âˆ§âˆ¨Â´âŸ¨f,Â»f,Â«f,Â»Ë˜f,Â«Ë˜fâŸ©
    nâ‰¢f?
    f â†© nâ‹„1;0
  } @
  mâˆ¨â†© f
  # â€¢Show âŒ½â‰âŒ½Ë˜âŠâŸœ"Â·#"m
  m <Ë˜â†©
  upt â† <Ë˜â‰>up
  mx â† 0
  {
    >Â´âŠ‘Â¨ğ•¨â€¿ğ•©?@;
    âŸ¨y0,x0âŸ©ğ•ŠâŸ¨y1,x1âŸ©:
      x0â€¿x1 âˆ§â†©
      y1â€¿x1+â†©1
      # x0â€¿y0+â†©1 â‹„ x1â€¿y1-â†©1
      sz â† Ã—Â´1+|-Â´âŠ‘Â¨âŸœulÂ¨ ğ•¨â€¿ğ•©
      ok â† âˆ§Â´{âˆ§Â´x0â†“x1â†‘ğ•©}Â¨ y0â†“y1â†‘m
      # â€¢Show okâ€¿szâ€¿ğ•¨â€¿ğ•©â€¿âŸ¨y0,x0,y1,x1âŸ©
      mxâŒˆâ†©okÃ—sz
  }âŒœËœ upt
  â€¢Show mx
}
